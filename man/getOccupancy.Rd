% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/implementation.R
\name{getOccupancy}
\alias{getOccupancy}
\title{Compute Read Occupancy from a BAM File}
\usage{
getOccupancy(
  bam_file = NULL,
  gene_name = NULL,
  features = NULL,
  total_reads = NULL
)
}
\arguments{
\item{bam_file}{A \code{character} string specifying the path to a BAM file.}

\item{gene_name}{A \code{character} string specifying the gene name whose read occupancy should be extracted.}

\item{features}{A \code{data.frame} containing transcript annotation information, including:
\describe{
\item{gene}{Character: Gene name.}
\item{idnew}{Character: Combined transcript ID (\code{transcript_id|gene_name}).}
\item{translen}{Integer: Transcript length.}
}}

\item{total_reads}{A \code{numeric} value indicating the total number of mapped reads
in the BAM file (used for RPM normalization).}
}
\value{
A \code{data.frame} containing per-position occupancy data:
\describe{
\item{rname}{Character: Transcript name (\code{transcript_id|gene_name}).}
\item{pos}{Integer: Position along the transcript.}
\item{count}{Integer: Number of reads that start at this position.}
\item{rpm}{Numeric: Normalized read occupancy (Reads Per Million, RPM).}
}
}
\description{
Extracts per-position read occupancy from an RNA-seq or ribosome profiling BAM file
for a given gene and normalizes the data to Reads Per Million (RPM).
}
\details{
This function extracts \strong{read occupancy} at each transcript position by:
\itemize{
\item Filtering the \code{features} table to extract transcript information.
\item Creating a genomic interval (\code{GRanges}) corresponding to the transcript.
\item Using \code{Rsamtools::scanBam()} to extract alignment start positions.
\item Aggregating read counts per position.
\item \strong{Normalizing to Reads Per Million (RPM)}:
}

\deqn{RPM = \frac{\text{count at position}}{\text{total_reads}} \times 10^6}
}
