% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gene-expression-analysis.R
\name{gene_differential_analysis}
\alias{gene_differential_analysis}
\alias{gene_differential_analysis,ribotrans-method}
\title{Gene Differential Expression Analysis}
\usage{
gene_differential_analysis(object, ...)

\S4method{gene_differential_analysis}{ribotrans}(
  object,
  type = c("rna", "ribo"),
  control_samples = NULL,
  treat_samples = NULL,
  lo2FC = c(-1, 1),
  pval = 0.05,
  norm_by_totalMappedReads = FALSE
)
}
\arguments{
\item{object}{A \code{ribotrans} object, which should already include count data generated by \code{get_counts()}.}

\item{...}{Additional arguments (currently unused).}

\item{type}{Character string specifying the library type to analyze. Either \code{"rna"} or \code{"ribo"}.}

\item{control_samples}{Character vector of sample names to serve as the control group.}

\item{treat_samples}{Character vector of sample names to serve as the treatment group.}

\item{lo2FC}{A numeric vector of length two specifying lower and upper thresholds for log2 fold change.
Default is \code{c(-1, 1)}, meaning fold changes below -1 or above 1 are considered significant.}

\item{pval}{Numeric. P-value threshold for statistical significance. Default is \code{0.05}.}

\item{norm_by_totalMappedReads}{A logical value. If \code{FALSE} (default), the
"per million" scaling factor is derived from the sum of counts assigned to
features in the current analysis (the standard way for TPM). If \code{TRUE}, the
scaling factor is the total number of mapped reads stored in the library
metadata (\code{object@library$mappped_reads}).}
}
\value{
A \code{data.frame} containing differential expression results, including:
\describe{
\item{\code{gene_id}}{Gene identifier}
\item{\code{log2FoldChange}}{Log2-transformed fold change between treatment and control}
\item{\code{pvalue, padj}}{Raw and adjusted p-values (if available)}
\item{\code{gene_name, gene_biotype}}{Gene annotation information}
\item{\code{type}}{Significance label: "sigUp", "sigDown", or "nonSig"}
}
}
\description{
Performs differential expression analysis on gene-level count data for either RNA-seq or Ribo-seq
experiments stored in a \code{ribotrans} object. The DESeq2 pipeline is used to identify differentially
expressed genes between control and treatment sample groups. Results include fold changes, p-values,
and gene annotations with significance classification.
}
\details{
This method uses the \pkg{DESeq2} package for differential gene expression analysis.
Gene annotations are automatically extracted from the stored count metadata.
}
\examples{
\dontrun{
# Assume `obj` is a ribotrans object with valid count data already obtained using get_counts()
# and has RNA samples: "ctrl1", "ctrl2", "treat1", "treat2"

result <- gene_differential_analysis(
  object = obj,
  type = "rna",
  control_samples = c("ctrl1", "ctrl2"),
  treat_samples = c("treat1", "treat2"),
  lo2FC = c(-1.5, 1.5),
  pval = 0.01
)

head(result)
table(result$type)
}

}
\seealso{
\code{\link{get_counts}}, \code{\link[DESeq2]{DESeq}}, \code{\link[DESeq2]{results}}
}
