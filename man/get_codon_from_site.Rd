% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pausing-site-calculation.R
\name{get_codon_from_site}
\alias{get_codon_from_site}
\alias{get_codon_from_site,ribotrans-method}
\title{Extract local codon or amino acid sequences around pause sites}
\usage{
get_codon_from_site(object, ...)

\S4method{get_codon_from_site}{ribotrans}(
  object,
  pause_data = NULL,
  cds_fa = NULL,
  left_extend = 5,
  right_extend = 5
)
}
\arguments{
\item{object}{A \code{ribotrans} object containing CDS annotations.}

\item{...}{Additional arguments (currently unused).}

\item{pause_data}{A data.frame containing pausing site positions.
typically the output of \code{\link{get_pausing_sites}}.}

\item{cds_fa}{A file path to the FASTA file containing CDS nucleotide sequences,
whose transcript names must match \code{object@features$idnew}.}

\item{left_extend}{Number of codons to include to the left (upstream) of the central site. Default: 5.}

\item{right_extend}{Number of codons to include to the right (downstream) of the central site. Default: 5.}
}
\value{
A data.frame with the following columns:
\describe{
\item{rname}{Transcript ID}
\item{codon_pos}{Codon index (1-based) within CDS}
\item{lp}{Start codon index of the extracted window (codon_pos - left_extend)}
\item{rp}{End codon index of the window (codon_pos + right_extend)}
\item{len}{Total codon length of the translated CDS}
\item{seqs}{Amino acid sequence for the window (length = left + right + 1)}
}
}
\description{
This function retrieves amino acid sequences surrounding detected ribosome stalling or pausing positions.
It uses the codon-relative position in CDS to extract windows of amino acids centered on pausing sites.

The function reads CDS transcript sequences from a FASTA file, translates them into amino acids,
and for each pause site stored in the global object \code{ps.wd.ft}, identifies the corresponding codon index.
A window of amino acids \code{left_extend} codons upstream and \code{right_extend} codons downstream are extracted.
Sites near transcript ends (where window is incomplete) are automatically removed.
}
\details{
This method helps to extract amino acid sequences surrounding ribosome pausing events, useful for motif analysis.
Transcripts containing ambiguous bases (e.g., N) in their CDS will be excluded automatically.
Sites near CDS boundaries that do not allow for full window extraction will also be excluded.

The pause site data must be from \code{\link{get_pausing_sites}}, which assigns \code{relst}
as the coordinate relative to CDS start. The codon index is computed with \code{(relst \%/\% 3) + 1}.

The returned data can be directly used for motif enrichment or amino acid logo analysis.
}
\examples{
\dontrun{
# Load a ribotrans object and get pausing sites
ps <- get_pausing_sites(ribo_obj)

# Extract amino acid context around pause sites
aa_context <- get_codon_from_site(
  object = ribo_obj,
  pause_data = ps,
  cds_fa = "path/to/CDS.fasta",
  left_extend = 5,
  right_extend = 5
)

head(aa_context)
}

}
\seealso{
\code{\link{get_pausing_sites}}
}
