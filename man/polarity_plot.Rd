% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/polarity-scores.R
\name{polarity_plot}
\alias{polarity_plot}
\alias{polarity_plot,ribotrans-method}
\title{Generate Polarity Score Density Plot}
\usage{
polarity_plot(object, ...)

\S4method{polarity_plot}{ribotrans}(
  object,
  do_offset_correct = FALSE,
  position_shift = 0,
  exclude_length = c(15, 15),
  min_counts = 64,
  mark_line_col = "grey50",
  orf_width = 5,
  orf_col = "grey",
  return_data = FALSE
)
}
\arguments{
\item{object}{A \code{ribotrans} object containing sequencing and ribosome profiling data.}

\item{...}{Additional arguments (currently unused).}

\item{do_offset_correct}{Logical. If \code{TRUE}, performs \strong{offset correction}
using \code{do_offset_correction()}. \strong{Default}: \code{FALSE}.}

\item{position_shift}{Integer defining how much to adjust \strong{ribosome footprint positions}
during offset correction. \strong{Default}: \code{0}.}

\item{exclude_length}{Numeric vector of length two, specifying the number of nucleotides
to exclude from the start and end of coding sequences. (Default: \code{c(15,15)})}

\item{min_counts}{Numeric, minimum threshold for the total read count of a gene to be included in the analysis. (Default: \code{64})}

\item{mark_line_col}{Character string defining the color of the vertical guiding lines marking key positions. (Default: \code{"grey50"})}

\item{orf_width}{Numeric, linewidth for the Open Reading Frame (ORF) annotation. (Default: \code{5})}

\item{orf_col}{Character string defining the color for the ORF annotation. (Default: \code{"grey"})}

\item{return_data}{Logical, if \code{TRUE}, returns processed density data instead of a plot. (Default: \code{FALSE})}
}
\value{
If \code{return_data = FALSE}, returns a \code{ggplot2} object visualizing the polarity score density by sample.
If \code{return_data = TRUE}, returns a \code{data.frame} containing calculated density values.
}
\description{
Generates a polarity score density plot for \code{ribotrans} objects.
The plot visualizes the distribution of calculated polarity scores across different samples.
}
\details{
\itemize{
\item Reads are normalized to \strong{Reads Per Million (RPM)} mapped reads.
\item Genes with read counts below \code{min_counts} are excluded from calculations.
\item Density is estimated using \strong{kernel density estimation (KDE)} with \code{density(..., adjust = 1)}.
\item Vertical dashed lines represent key regions: \code{x = 0} (balanced polarity) and \verb{max density peak} per sample.
\item The ORF region is annotated as a reference.
}
}
\examples{
\dontrun{
# Generate polarity plot for a `ribotrans` object
polarity_plot(ribo_obj)

# Retrieve the processed density data instead of a plot
data <- polarity_plot(ribo_obj, return_data = TRUE)
head(data)
}

}
