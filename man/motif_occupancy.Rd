% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/motif-occupancy.R
\name{motif_occupancy}
\alias{motif_occupancy}
\alias{motif_occupancy,ribotrans-method}
\title{Motif Occupancy Analysis}
\usage{
motif_occupancy(object, ...)

\S4method{motif_occupancy}{ribotrans}(
  object,
  merge_rep = FALSE,
  cds_fa = NULL,
  do_offset_correct = FALSE,
  position_shift = 0,
  search_type = c("amino", "codon"),
  exclude_length = c(100, 100),
  min_counts = 64,
  motif_pattern = "PPP",
  facet_layer = facet_wrap(~motif),
  return_data = FALSE
)
}
\arguments{
\item{object}{A \code{ribotrans} object containing processed ribosome profiling data.}

\item{...}{Additional arguments (currently unused).}

\item{merge_rep}{Logical. Whether to merge replicates (\code{sample_group}) during analysis. Default: \code{FALSE}.}

\item{cds_fa}{Character. Path to the CDS FASTA file. The sequences are filtered and translated depending on \code{search_type}.}

\item{do_offset_correct}{Logical. Whether to perform read offset correction before summarizing coverage. Default: \code{FALSE}.}

\item{position_shift}{Numeric. Integer value to apply as position shift during offset correction. Default: \code{0}.}

\item{search_type}{Character. Specifies motif space used for searching: either \code{"amino"} (peptide sequence) or \code{"codon"} (nucleotide codon sequences). Default: \code{"amino"}.}

\item{exclude_length}{A numeric vector of length two specifying the number of nucleotides
to exclude from the start and end of the CDS to avoid boundary effects. Default is \code{c(100, 100)}.}

\item{min_counts}{Integer. Minimum number of total reads required for a transcript to be included in occupancy calculation. Default: 64.}

\item{motif_pattern}{Character vector. Motif string(s) to search in amino acid or codon space, e.g., \code{c("PPP", "KKK")}.}

\item{facet_layer}{ggplot2 facet call. Faceting layer for ECDF plot. Default: \code{facet_wrap(~motif)}.}

\item{return_data}{Logical. If \code{TRUE}, returns the data.frame of motif-level occupancy; otherwise returns a ggplot object. Default: \code{FALSE}.}
}
\value{
If \code{return_data = FALSE} (default), returns a \code{ggplot} object showing ECDF curves of log2-transformed codon/amino acid occupancies at motif locations.
If \code{return_data = TRUE}, returns a \code{data.frame} containing normalized occupancy values for each motif instance.
}
\description{
This function calculates the occupancy of specified motifs (either amino acid string or codon pattern) within coding sequence (CDS) regions using ribosome profiling data stored in a ribotrans object.
It optionally performs read offset correction, aggregates biological replicates, and visualizes the relative occupancy as cumulative distribution curves (ECDFs).
}
\details{
This function performs:
\enumerate{
\item CDS filtering and translation
\item Identification of motif positions across transcripts
\item Read normalization (per-length scaling)
\item Relative density calculation
\item Visualization of cumulative codon/amino acid occupancy at motif positions
}
}
\examples{
\dontrun{
motif_occupancy(
object = ribo_obj,
cds_fa = "coding_sequences.fasta",
search_type = "amino",
motif_pattern = c("PPP", "KKK"),
do_offset_correct = TRUE,
merge_rep = TRUE
)
}

}
\seealso{
\code{\link{do_offset_correction}}
}
