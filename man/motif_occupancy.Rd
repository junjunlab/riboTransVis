% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/motif-occupancy.R
\name{motif_occupancy}
\alias{motif_occupancy}
\alias{motif_occupancy,ribotrans-method}
\title{Analyze Codon or Amino Acid Motif Occupancy from Ribosome Profiling Data}
\usage{
motif_occupancy(object, ...)

\S4method{motif_occupancy}{ribotrans}(
  object,
  merge_rep = FALSE,
  cds_fa = NULL,
  do_offset_correct = FALSE,
  position_shift = 0,
  search_type = c("amino", "codon"),
  exclude_length = c(45, 45),
  min_counts = 64,
  motif_pattern = "PPP",
  insert_box = TRUE,
  box_pos = c(0.99, 0.5),
  box_width_height = c(0.3, 0.8),
  return_data = FALSE
)
}
\arguments{
\item{object}{A \code{ribotrans} object containing preprocessed ribosome profiling data with corresponding annotations in \code{@features} and positional read density in \code{@summary_info}.}

\item{...}{Additional arguments (currently unused).}

\item{merge_rep}{Logical. If \code{TRUE}, replicates from the same \code{sample_group} will be averaged before visualization. Default is \code{FALSE}.}

\item{cds_fa}{Path to the CDS fasta file with transcript nucleotide sequences.}

\item{do_offset_correct}{Logical. If \code{TRUE}, perform read offset correction using \code{do_offset_correction()}. Default is \code{FALSE}.}

\item{position_shift}{Integer. Number of nucleotides used to correct P-site position. Default is 0.}

\item{search_type}{Search level: "amino" (default) or "codon". Determines whether the motif is searched at the amino acid or codon sequence level.}

\item{exclude_length}{Integer vector of length 2. Number of codons to exclude from the start and end of CDS. Default is \code{c(45, 45)}.}

\item{min_counts}{Integer. Minimum read count per transcript to include for analysis. Default is 64.}

\item{motif_pattern}{Character vector. Motif(s) (amino acids or nucleotides) to search for. Default is "PPP".}

\item{insert_box}{Logical. Whether to include an inset boxplot in ECDF plots. Default is \code{TRUE}.}

\item{box_pos}{Numeric vector of length 2. The relative position (npc coordinates) of the inset box. Default is \code{c(0.99, 0.5)}.}

\item{box_width_height}{Numeric vector of length 2. Absolute width and height of the inset box. Default is \code{c(0.3, 0.8)}.}

\item{return_data}{Logical. If \code{TRUE}, return data frame instead of plotting. Default is \code{FALSE}.}
}
\value{
If \code{return_data = FALSE}, returns a \code{ggplot2} object with motif occupancy plots. Otherwise returns a data frame of motif positions and relative occupancy values.
}
\description{
This function calculates and visualizes motif-level translational occupancy from a \code{ribotrans} object, assessing motif-specific ribosome densities at codon or amino acid resolution. It provides options for offset correction, motif searching, replicate merging, and boxplot insets.
}
\details{
This function determines transcript positions matching specified motifs (on codon or amino acid level) and evaluates their normalized ribosome occupancy. Occupancy is calculated as read density normalized by transcript average. Plots display the distribution of log2 occupancy for each motif using ECDF curves. Optionally, inset boxplots illustrate sample-wise distributions.

The analysis includes CDS filtering, motif location extraction, optional offset correction, normalization of read counts, and final plotting with optional replicate merging.

Requires packages: \code{Biostrings}, \code{fastplyr}, \code{data.table}, \code{ggplot2}, \code{cowplot}, and optionally \code{ggpp}.
}
\examples{
\dontrun{
motif_occupancy(object = ribo_obj,
cds_fa = "cds.fa",
motif_pattern = c("PPP", "GGG"),
search_type = "amino")
}

}
