% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/motif-logo.R
\name{logo_plot}
\alias{logo_plot}
\title{Plot Sequence Logos with Multiple Visualization Methods}
\usage{
logo_plot(
  foreground_seqs = NULL,
  background_seqs = NULL,
  rev_stack_order = FALSE,
  type = c("merge", "sep"),
  col_scheme = "chemistry2",
  method = c("bits", "prob", "EDLogo", "enrich"),
  return_data = FALSE
)
}
\arguments{
\item{foreground_seqs}{A character vector of foreground sequences (aligned peptide motifs) or a matrix. This input is used across all plotting modes.}

\item{background_seqs}{Optional character vector of background sequences. Only used when \code{method = "enrich"} to compute enrichment over a background model.}

\item{rev_stack_order}{Logical. Whether to reverse the stacking order of residues within each logo column. Default is \code{FALSE}.}

\item{type}{Character. Either \code{"merge"} (default) to plot a unified enrichment logo or \code{"sep"} to plot enriched and depleted residues in separate panels. Only applies when \code{method = "enrich"}.}

\item{col_scheme}{Character. Amino acid color scheme used for rendering logos. Passed to \code{ggseqlogo()}.}

\item{method}{Character. Visualization method. Can be one of:
\itemize{
\item \code{"bits"}: Shannon bit-based sequence logo (information content, uses \pkg{ggseqlogo}).
\item \code{"prob"}: Residue probability-based logo (uses \pkg{ggseqlogo}).
\item \code{"EDLogo"}: Uses EDLogo rendering from package \pkg{Logolas}.
\item \code{"enrich"}: Enrichment logo showing log2 ratio of foreground vs background residue frequencies.
}}

\item{return_data}{Logical. If \code{TRUE}, returns the log2 enrichment matrix instead of a plot (only valid when \code{method = "enrich"}). Defaults to \code{FALSE}.}
}
\value{
A \code{ggplot} object (or a \code{cowplot} object when \code{type = "sep"}) representing the motif logo visualization.
}
\description{
This function creates sequence logo plots using various visualization approaches,
including Shannon bits, probabilities, EDLogo, and enrichment-based log2-ratio logos.
}
\details{
\code{logo_plot()} allows for visualizing motifs using traditional or comparative methods:
\itemize{
\item For \code{"bits"} and \code{"prob"}, only foreground data is used.
\item For \code{"EDLogo"}, a matrix or data frame is expected and will be passed to \code{Logolas::logomaker()}.
\item For \code{"enrich"}, foreground and background sequences are processed into position-specific frequency matrices, followed by computation of a log2-ratio enrichment matrix. This matrix is used to construct the pLogo-style enriched/depleted visualization.
\item Negative log2 values indicate depletion; positive values indicate enrichment.
}
In \code{"enrich"} mode with \code{type = "sep"}, the plot is split into "enriched" (positive) and "depleted" (negative) panels using \pkg{cowplot}.
}
\note{
The \code{"enrich"} method requires background sequences and assumes sequences are aligned and of the same length. \code{Biostrings} is used internally for consensus matrix generation.
}
\examples{
\dontrun{
## Bits-based logo
fg <- c("AKTGRRKS", "AKSGRRKS", "AKTRRRRS")
logo_plot(foreground_seqs = fg, method = "bits")

## Enrichment logo (merge)
bg <- c("AKAAAKTS", "AKVVVKTS", "AKGGGKTS", "AKSSSKTS")
logo_plot(foreground_seqs = fg, background_seqs = bg, method = "enrich", type = "merge")

## Enrichment logo (split panels)
logo_plot(foreground_seqs = fg, background_seqs = bg, method = "enrich", type = "sep")
}

}
