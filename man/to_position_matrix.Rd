% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{to_position_matrix}
\alias{to_position_matrix}
\title{Convert Aligned Sequences to a Position Frequency Matrix}
\usage{
to_position_matrix(seqs, seq_type)
}
\arguments{
\item{seqs}{A Biostrings XStringSet object. Must be an instance of AAStringSet (for protein sequences), DNAStringSet (for DNA), or RNAStringSet (for RNA).}

\item{seq_type}{Character. Type of sequence, must be one of: \code{"aa"}, \code{"dna"}, or \code{"rna"}. Determines the allowed residues/bases for row filtering.}
}
\value{
A matrix where rows correspond to residues or bases, and columns correspond to positions in the aligned sequences. Each value in the matrix represents the count of a particular character at a given position.
}
\description{
This function converts a set of aligned biological sequences into a position frequency matrix (PFM) using Biostrings::consensusMatrix(). It supports amino acid (AA), DNA, and RNA sequence types and filters the result to include only expected characters for the given type.
}
\details{
This function uses \code{Biostrings::consensusMatrix()} to calculate a position-wise summary of aligned sequences. The result is filtered to retain only rows corresponding to valid residues/bases for the specified sequence type:
\itemize{
\item \code{"aa"}: 20 standard amino acids (A, R, N, D, ... V)
\item \code{"dna"}: A, C, G, T
\item \code{"rna"}: A, C, G, U
}
}
\examples{
\dontrun{
library(Biostrings)

# DNA example
dna_seqs <- DNAStringSet(c("ATGG", "ATGC", "ATGT"))
mat_dna <- to_position_matrix(dna_seqs, seq_type = "dna")
print(mat_dna)

# Protein example
aa_seqs <- AAStringSet(c("ARND", "ARNE", "ARNQ"))
mat_aa <- to_position_matrix(aa_seqs, seq_type = "aa")
print(mat_aa)
}

}
\seealso{
\code{\link[Biostrings]{consensusMatrix}}
}
