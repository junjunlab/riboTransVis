% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/motif-logo.R
\name{plogo_plot}
\alias{plogo_plot}
\title{Statistical Sequence Logo Plot (pLogo-style)}
\usage{
plogo_plot(
  foreground_seqs = NULL,
  background_seqs = NULL,
  rev_stack_order = TRUE,
  seq_type = c("aa", "dna", "rna"),
  type = c("merge", "sep"),
  col_scheme = "chemistry2",
  npcx = 0.98,
  npcy = 0.98,
  size = 3.5,
  return_data = FALSE
)
}
\arguments{
\item{foreground_seqs}{A character vector or Biostrings::XStringSet of aligned foreground sequences
(e.g. amino acid motif windows).}

\item{background_seqs}{A character vector or Biostrings::XStringSet of aligned background sequences. Required.}

\item{rev_stack_order}{Logical. Reverse the stacking order of letters (default: TRUE).}

\item{seq_type}{Character. Sequence type, one of \code{"aa"} (amino acid), \code{"dna"}, or \code{"rna"}.}

\item{type}{Character. Display style. If \code{"merge"}, plot shows both enriched/depleted residues
in one panel. If \code{"sep"}, returns a top and bottom panel separately (like canonical pLogo).}

\item{col_scheme}{Character. Color scheme to use, passed to \code{ggseqlogo}. Default: \code{"chemistry2"}.}

\item{npcx}{Numeric \verb{[0–1]}. X position (NPC units) for annotation text.}

\item{npcy}{Numeric \verb{[0–1]}. Y position (NPC units) for annotation text.}

\item{size}{Numeric. Text size of the annotation.}

\item{return_data}{Logical. If \code{TRUE}, returns the internally computed log-odds matrix instead of a plot.}
}
\value{
A ggplot object showing a sequence logo with log-probability-scaled residue heights, or a numeric
matrix of log-odds ratios if \code{return_data=TRUE}.
}
\description{
This function generates a statistical sequence logo (pLogo-style) that visualizes overrepresented and
underrepresented residues based on a binomial test. It compares position-specific counts
in a foreground and background dataset using a log-odds scoring approach. A Bonferroni-corrected
significance threshold (P < 0.05) is used to display a reference line.
}
\details{
This implementation follows the principles of the pLogo algorithm (O’Shea et al, Nature Methods, 2013):
residues are scaled according to the log odds of their binomial probability of enrichment or depletion
given the background. Significant thresholds are marked with dashed lines, using Bonferroni-corrected tests.

A red dashed horizontal line is shown at:
\deqn{\pm \log_{10}\left(\frac{\alpha'}{1-\alpha'}\right)}
where \eqn{\alpha'} is the corrected significance level, accounting for multiple testing:
\deqn{\alpha' = \frac{0.05}{N_{positions} \times N_{residues} - N_{zero\ fg}}}
}
\examples{
\dontrun{
library(Biostrings)
fg <- c("ARND", "ARNE", "ARNQ", "ARNA")
bg <- rep(c("ARND", "GHIL", "PQRS"), each = 5)
plogo_plot(fg, bg, seq_type = "aa", type = "merge")
}

}
\references{
O’Shea JP, Chou MF, Quader SA, Ryan JK, Church GM, Schwartz D. pLogo: a probabilistic
approach to visualizing sequence motifs. Nat Methods. 2013 Dec;10(12):1211–1212. \doi{10.1038/nmeth.2646}
}
