% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/motif-logo.R
\name{plogo_plot}
\alias{plogo_plot}
\title{Plot a pLogo-style Logo Based on Foreground and Background Sequences}
\usage{
plogo_plot(
  foreground_seqs = NULL,
  background_seqs = NULL,
  rev_stack_order = TRUE,
  type = c("merge", "sep"),
  col_scheme = "chemistry2",
  npcx = 0.98,
  npcy = 0.98,
  size = 3.5,
  return_data = FALSE
)
}
\arguments{
\item{foreground_seqs}{A character vector of amino acid sequences representing the foreground dataset.}

\item{background_seqs}{A character vector of amino acid sequences representing the background dataset.}

\item{rev_stack_order}{Logical. Should the residue stacks be ordered with the most significant on top? Default is TRUE.}

\item{type}{Character. Choose between \code{"merge"} (combined enriched and depleted in one plot) or \code{"sep"} (two-panel for enriched/depleted). Default is "merge".}

\item{col_scheme}{Residue color scheme passed to \code{ggseqlogo}; default is \code{"chemistry2"}.}

\item{npcx}{Numeric. Relative x-position for annotation text via \code{geom_text_npc()}; default is 0.98.}

\item{npcy}{Numeric. Relative y-position for annotation text; default is 0.98.}

\item{size}{Numeric. Font size for annotation text. Default is 3.5.}

\item{return_data}{Logical; if \code{TRUE}, returns the log-odds matrix instead of the plot. Default: \code{FALSE}.}
}
\value{
A ggplot object displaying the pLogo-style sequence logo, or a numeric matrix of log-odds enrichment scores if \code{return_data = TRUE}.
}
\description{
This function visualizes statistically enriched or depleted amino acid positions
from aligned sequences. It uses binomial probabilities to calculate log-odds scores
and generates a pLogo-like sequence logo using \code{ggseqlogo}. Both enriched and
depleted residues are shown, and a Bonferroni-corrected significance bar is added.
}
\details{
Internally, this function performs several steps:
\itemize{
\item Parses and counts each amino acid by position for both foreground and background sequences.
\item Builds position matrices and computes frequency matrix for the background.
\item Calculates residue log-odds using a binomial over/under probability ratio, via \code{get_log_ratio_mat()}.
\item Adds red dashed lines to show Bonferroni-corrected p-value threshold (typically P < 0.05).
\item Optionally splits plots into enriched and depleted panels (\code{type = "sep"}).
}

Visualization is constructed using \code{ggseqlogo} and optionally arranged using the \code{patchwork} package.
}
\examples{
\dontrun{
# Example: Generate logo from short protein sequences
fg <- c("ARGGGKTSV", "ARRRGKTSV", "ARSGGKTSV")
bg <- c("AKGGGKTSV", "ALGGGKTSV", "AKGGGKTSV", "ARAGGKTSV")

plogo_plot(
  foreground_seqs = fg,
  background_seqs = bg,
  type = "merge",
  col_scheme = "chemistry2"
)
}

}
