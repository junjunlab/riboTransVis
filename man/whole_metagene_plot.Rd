% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualization-QC.R
\name{whole_metagene_plot}
\alias{whole_metagene_plot}
\alias{whole_metagene_plot,ribotrans-method}
\title{Generate Metagene Profile Plot for Ribosome Density}
\usage{
whole_metagene_plot(object, ...)

\S4method{whole_metagene_plot}{ribotrans}(
  object,
  auto_scale = FALSE,
  merge_rep = FALSE,
  custom_scale = c(0.3, 0.3),
  geom_density_bw = 5e-04,
  geom_density_n = 512,
  return_data = FALSE
)
}
\arguments{
\item{object}{A \code{ribotrans} object containing summarized ribosome profiling data.}

\item{...}{Additional arguments (currently unused).}

\item{auto_scale}{Logical. If \code{TRUE}, the function automatically scales UTR lengths
relative to the CDS region using the median UTR/CDS lengths across all transcripts.
Default is \code{FALSE}, meaning manual scaling is used (via \code{custom_scale}).}

\item{merge_rep}{Logical. Whether to merge replicate samples by \code{sample_group}. Default is \code{FALSE}.}

\item{custom_scale}{A numeric vector of length \strong{2} specifying the relative scaling
factors for \strong{5' UTR and 3' UTR} (relative to CDS length).
\strong{Default}: \code{c(0.3, 0.3)}, where both UTRs are \strong{30\% the size of the CDS region}.}

\item{geom_density_bw}{Bandwidth for \code{geom_density()}. Controls the smoothness
of the density plot. \strong{Default}: \code{0.0005}.}

\item{geom_density_n}{Number of points used to generate the density estimate.
\strong{Default}: \code{512}. Lower values can speed up computations.}

\item{return_data}{Logical. If \code{FALSE}, returns a \code{ggplot2} object for visualization.
If \code{TRUE}, returns \strong{processed transcript-level ribosome density data} as a \code{data.frame}.
\strong{Default}: \code{FALSE} (returns plot).}
}
\value{
If \code{return_data = FALSE}, returns a \code{ggplot2} object displaying \strong{ribosome density profiles} across \verb{5' UTR}, \code{CDS}, and \verb{3' UTR}.
If \code{return_data = TRUE}, returns a \code{data.frame} containing the \strong{scaled relative ribosome density positions}.
}
\description{
This function creates a \strong{metagene profile plot} to visualize ribosome density
across different transcript features (5' UTR, CDS, and 3' UTR).
}
\details{
\itemize{
\item This function calculates a \strong{relative distance metric} for each read's mapped position and scales them appropriately into \strong{5' UTR, CDS, and 3' UTR regions}.
\item If \code{auto_scale = TRUE}, the function automatically estimates median UTR/CDS
scaling factors from the dataset.
\item The \strong{X-axis} represents normalized transcript positions:
\itemize{
\item \code{1} → start codon of the \strong{CDS}
\item \code{2} → stop codon of the \strong{CDS}
\item \verb{Scaled values between 0 and 1} → \strong{5' UTR}
\item \verb{Scaled values between 2 and 3} → \strong{3' UTR}
}
\item \strong{Dashed reference lines} (\code{geom_vline()}) mark \strong{CDS start (1)} and \strong{CDS stop (2)}.
}
}
\examples{
\dontrun{
# Generate a metagene plot
whole_metagene_plot(obj)

# Return processed density data instead of plot
density_data <- whole_metagene_plot(obj, return_data = TRUE)
head(density_data)

# Adjust kernel density bandwidth for smoother plot
whole_metagene_plot(obj, geom_density_bw = 0.001)
}

}
