% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/serp-binding-peaks-detection.R
\name{find_weak_peaks}
\alias{find_weak_peaks}
\alias{find_weak_peaks,serp-method}
\title{Find Weak Binding Peaks in Selective Ribo-seq (SeRP) Data}
\usage{
find_weak_peaks(object, ...)

\S4method{find_weak_peaks}{serp}(
  object,
  do_offset_correct = FALSE,
  position_shift = 0,
  min_counts = 32,
  read_length = c(25, 35),
  smooth = TRUE,
  window_size = 45,
  background_width = 90,
  enrichment_threshold = 3,
  binding_width = 15,
  mode = c("nt", "codon")
)
}
\arguments{
\item{object}{A \code{serp} object containing processed SeRP data, including normalized read coverage (RPM), transcript annotations, and sample metadata.}

\item{...}{Additional arguments (currently unused).}

\item{do_offset_correct}{Logical. Whether to apply P-site offset correction. Default is \code{FALSE}.}

\item{position_shift}{Integer. Position shift applied during offset correction. Only used when \code{do_offset_correct = TRUE}. Default is \code{0}.}

\item{min_counts}{Integer. Minimum total read counts required per gene per sample to be included in the analysis. Default is \code{32}.}

\item{read_length}{Integer vector of length 2 representing the minimum and maximum read lengths to retain for analysis. Default is \code{c(25, 35)}.}

\item{smooth}{Logical. Whether to smooth read signal using a rolling window. Default is \code{TRUE}.}

\item{window_size}{Integer. Size of the rolling window width for smoothing. Only used if \code{smooth = TRUE}. Default is \code{45}.}

\item{background_width}{Integer. Width of the initial region in each transcript used to estimate the background RPM signal. Default is \code{90}.}

\item{enrichment_threshold}{Numeric. Minimum enrichment ratio (rpm/background_mean) required for a genome region to be classified as a peak. Typical value is \code{3}. Default is \code{3}.}

\item{binding_width}{Integer. Minimum width (in nucleotides or codons) of a contiguous high-ratio region for it to qualify as a peak. Default is \code{15}.}

\item{mode}{Character. Indicates whether the output coordinates refer to "nt" (nucleotides) or "codon" (triplet resolution). Default is \code{"nt"}.}
}
\value{
A \code{data.frame} with identified weak binding peaks, containing the following columns:
\item{sample}{Sample identifier}
\item{sample_group}{Group to which the sample belongs}
\item{rname}{Transcript or gene name}
\item{start}{Start position of the peak (in nucleotides or codons)}
\item{end}{End position of the peak (in nucleotides or codons)}
\item{mean_ratio}{Average enrichment ratio within the peak}
\item{binding_width}{Peak width (in nucleotides or codons)}
}
\description{
This function identifies weak binding peaks in IP (selective) ribosome profiling (SeRP) data. Peaks are regions in a transcript where the normalized read coverage (RPM) exceeds a specified fold-change relative to the transcript's background region (typically the first few codons/nucleotides) for at least a minimum width. This analysis helps discover candidate RNA-binding protein (RBP) footprints that are weaker but reproducible.
}
\details{
This function only analyzes "-ip" type SeRP samples to find weak binding events. The RPM signal is compared to a background signal estimated from the first \code{background_width} nucleotides of the coding region. Smoothing can enhance reproducibility and reduce noise.

Peaks are filtered by a minimum enrichment threshold and length. Optionally, codon-level resolution can be returned.
}
\section{Signal Smoothing}{

If \code{smooth = TRUE}, the function uses a centered rolling sum with window size \code{window_size} via the \pkg{RcppRoll} package.
}

\examples{
\dontrun{
peaks <- find_weak_peaks(object = my_serp,
do_offset_correct = TRUE,
position_shift = 12,
min_counts = 20,
read_length = c(25, 34),
smooth = TRUE,
window_size = 45,
background_width = 90,
enrichment_threshold = 3,
binding_width = 15,
mode = "codon")
head(peaks)
}

}
\seealso{
\code{\link{find_strong_peaks}}, \code{\link{do_offset_correction}}, \code{\link{serp-class}}
}
