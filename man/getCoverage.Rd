% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/implementation.R
\name{getCoverage}
\alias{getCoverage}
\title{Extract Coverage Information from a BAM File}
\usage{
getCoverage(
  bam_file = NULL,
  gene_name = NULL,
  features = NULL,
  total_reads = NULL
)
}
\arguments{
\item{bam_file}{A \code{character} string specifying the path to a BAM file.}

\item{gene_name}{A \code{character} string indicating the gene name to extract coverage for.}

\item{features}{A \code{data.frame} containing transcript annotations, including:
\describe{
\item{gene}{Character: Gene name.}
\item{idnew}{Character: Combined transcript ID (\code{transcript_id|gene_name}).}
\item{translen}{Integer: Total transcript length.}
}}

\item{total_reads}{A \code{numeric} value representing the total number of mapped reads
in the BAM file (used for RPM normalization).}
}
\value{
A \code{data.frame} with per-position read coverage, containing:
\describe{
\item{rname}{Character: Transcript name (\code{transcript_id|gene_name}).}
\item{pos}{Integer: Position along the transcript.}
\item{count}{Integer: Raw read count at this position.}
\item{strand}{Character: Strand information (if applicable).}
\item{rpm}{Numeric: Normalized read count (Reads Per Million, RPM).}
}
}
\description{
Computes read coverage for a given gene from an RNA-seq or ribosome profiling BAM file.
}
\details{
This function extracts per-position read coverage for the given \code{gene_name} by:
\enumerate{
\item Filtering the \code{features} data frame to match the target gene.
\item Defining the transcript region (\code{GRanges} format).
\item Using \code{Rsamtools::pileup()} to compute coverage at each position.
\item Normalizing counts to Reads Per Million (RPM).
}

RPM is computed as:
\deqn{RPM = \frac{\text{count at position}}{\text{total_reads}} \times 10^6}
}
