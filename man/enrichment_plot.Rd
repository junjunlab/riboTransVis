% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/serp-visualization.R
\name{enrichment_plot}
\alias{enrichment_plot}
\alias{enrichment_plot,serp-method}
\title{Enrichment Profile Plot for SERP Object}
\usage{
enrichment_plot(object, ...)

\S4method{enrichment_plot}{serp}(
  object,
  cds_line = c("#CC6600", 4),
  line_col = "#377CC0",
  shadow_alpha = c(0.1, 0.3),
  enrich_threshold = 1,
  new_signal_range = F,
  range_x = 0.99,
  range_y = 0.98,
  range_size = 4,
  range_digit = 1,
  facet = facet_grid(sample ~ rname, switch = "y"),
  nrow = NULL,
  ncol = NULL
)
}
\arguments{
\item{object}{An object of class \code{serp}. Must contain enrichment data calculated via \code{get_enrichment}.}

\item{...}{Additional arguments (currently unused).}

\item{cds_line}{A vector specifying the color and line width of the CDS start marker. Default: \code{c("#CC6600", 4)}.}

\item{line_col}{Color of enrichment line and the fill of confidence interval rectangles. Default: \code{"#377CC0"}.}

\item{shadow_alpha}{A numeric vector of length 2 for the alpha transparency range (min, max) of the enrichment CI shading. Default: \code{c(0.1, 0.3)}.}

\item{enrich_threshold}{A numeric scalar defining the horizontal dashed line threshold for enrichment (e.g., 1 = equal signal). Default: \code{1}.}

\item{new_signal_range}{Logical, whether to annotate a textual enrichment signal range label (from 0 to max upper). Default: \code{FALSE}.}

\item{range_x}{X position of the signal range label, in NPC units (0–1). Used only if \code{new_signal_range = TRUE}. Default: \code{0.99}.}

\item{range_y}{Y position of the signal range label, in NPC units (0–1). Default: \code{0.98}.}

\item{range_size}{Text size of the signal range annotation. Default: \code{4}.}

\item{range_digit}{Number of digits to round in signal range label. Default: \code{1}.}

\item{facet}{A ggplot2 faceting specification, e.g., \code{facet_grid(sample~rname)}. Default: \code{facet_grid(sample~rname, switch = "y")}.}

\item{nrow, ncol}{Number of rows and columns in multi-figure layout when plotting multiple transcripts. Default: \code{NULL} (automatic).}
}
\value{
A patchwork of enrichment line plots (using cowplot::plot_grid), one per transcript.
Additionally shows enrichment variability via shaded area and optionally range labeling and CDS marks.
}
\description{
Visualizes the ribosome profiling signal enrichment (IP / total) from a \code{serp} object.
For each transcript, the function plots the enrichment curve and uncertainty shading,
optionally with customized signal ranges, CDS boundary annotation, and faceting layout.
Requires \code{get_enrichment} to be run beforehand.
}
\examples{
\dontrun{
# Assuming `x` is a serp object with enrichment already computed
enrichment_plot(x)
enrichment_plot(x, cds_line = c("red", 2), enrich_threshold = 1.5, new_signal_range = TRUE)
}

}
\seealso{
\code{\link{get_enrichment}} for enrichment computation.
}
