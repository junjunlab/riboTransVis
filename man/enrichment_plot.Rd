% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/serp-visualization.R
\name{enrichment_plot}
\alias{enrichment_plot}
\alias{enrichment_plot,serp-method}
\title{Plot Enrichment Ratios from Selective Ribosome Profiling}
\usage{
enrichment_plot(object, ...)

\S4method{enrichment_plot}{serp}(
  object,
  cds_line = c("#CC6600", 4),
  line_col = "#377CC0",
  shadow_alpha = c(0.1, 0.3),
  enrich_threshold = 1,
  new_signal_range = F,
  range_x = 0.99,
  range_y = 0.98,
  range_size = 4,
  range_digit = 1,
  nrow = NULL,
  ncol = NULL
)
}
\arguments{
\item{object}{An S4 object containing enrichment data.}

\item{...}{Additional arguments passed to specific method implementations.}

\item{cds_line}{Vector. Color and line width for the CDS indicator line. Default: c("#CC6600", 4).}

\item{line_col}{Character. Color of the enrichment line. Default: "#377CC0" (blue).}

\item{shadow_alpha}{Numeric vector. Alpha range for confidence interval shading. Default: c(0.1, 0.3).}

\item{enrich_threshold}{Numeric. Threshold line for enrichment ratio. Default: 1.}

\item{new_signal_range}{Logical. Whether to display signal range annotation. Default: FALSE.}

\item{range_x}{Numeric. X position of signal range annotation (normalized). Default: 0.99.}

\item{range_y}{Numeric. Y position of signal range annotation (normalized). Default: 0.98.}

\item{range_size}{Numeric. Font size of signal range annotation. Default: 4.}

\item{range_digit}{Numeric. Number of decimal places for signal range annotation. Default: 1.}

\item{nrow}{Numeric. Number of rows when arranging multiple plots. Default: NULL.}

\item{ncol}{Numeric. Number of columns when arranging multiple plots. Default: NULL.}
}
\value{
A plot visualizing the enrichment data.

A ggplot object or a combined plot grid if multiple transcripts are present.
}
\description{
Generic function for plotting enrichment ratios from selective ribosome profiling experiments.
}
\details{
This is a generic function that creates visualizations of enrichment ratios between
immunoprecipitated (IP) and total ribosome profiling samples. The specific implementation
depends on the class of the input object.

For objects of class 'serp', this method creates a visualization of the enrichment ratio
between IP and total ribosome profiling samples. The method requires enrichment data to be
present in the 'enriched_ratio' slot of the object, which can be calculated using the
\code{get_enrichment} method.

The plot includes:
\enumerate{
\item A line representing the mean enrichment ratio at each position
\item Shaded areas representing confidence intervals, with opacity reflecting precision
\item A dashed horizontal line at the specified enrichment threshold (typically 1)
\item A bar at the bottom indicating the coding sequence (CDS) region
\item Optional signal range annotation
}

The x-axis is scaled to represent codon/amino acid positions rather than nucleotide positions.
}
\section{Methods (by class)}{
\itemize{
\item \code{enrichment_plot(serp)}: Plot enrichment ratios for SERP objects

}}
\examples{
\dontrun{
# Process a serp object
serp_obj <- get_occupancy(serp_obj, serp_exp = "total")
serp_obj <- get_occupancy(serp_obj, serp_exp = "ip")
serp_obj <- get_enrichment(serp_obj)

# Create enrichment plot
enrichment_plot(serp_obj)
}

\dontrun{
# Process a serp object
serp_obj <- get_occupancy(serp_obj, serp_exp = "total")
serp_obj <- get_occupancy(serp_obj, serp_exp = "ip")
serp_obj <- get_enrichment(serp_obj)

# Basic enrichment plot
enrichment_plot(serp_obj)

# Customized enrichment plot
enrichment_plot(serp_obj,
               line_col = "darkred",
               shadow_alpha = c(0.05, 0.2),
               enrich_threshold = 1.5,
               new_signal_range = TRUE)

# Multiple transcripts in a grid
enrichment_plot(serp_obj, nrow = 2, ncol = 3)
}

}
