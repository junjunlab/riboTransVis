% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/serp-visualization.R
\name{enrichment_plot2}
\alias{enrichment_plot2}
\alias{enrichment_plot2,serp-method}
\title{Plot Enrichment Profiles for Target Gene}
\usage{
enrichment_plot2(object, ...)

\S4method{enrichment_plot2}{serp}(
  object,
  merge_rep = FALSE,
  var_alpha = 0.5,
  smooth = TRUE,
  window_size = 45,
  retain_cds = TRUE,
  mode = c("codon", "nt"),
  new_signal_range = FALSE,
  enrich_threshold = 1,
  range_x = 0.99,
  range_y = 0.98,
  range_size = 4,
  range_digit = 1,
  exon_line = c("grey", 3),
  cds_line = c("grey30", 7),
  facet = facet_grid(sample ~ rname, switch = "y"),
  nrow = NULL,
  ncol = NULL,
  return_data = FALSE
)
}
\arguments{
\item{object}{A \code{serp} object generated and processed by previous analysis steps (must include \code{total_occupancy}, \code{ip_occupancy}, and \code{features}).}

\item{...}{Additional arguments (currently unused).}

\item{merge_rep}{Logical; whether to merge biological replicates (sample groups) for plotting. Default is \code{FALSE}.}

\item{var_alpha}{Alpha transparency level for shaded error region (standard deviation) when \code{merge_rep = TRUE}. Default is 0.5.}

\item{smooth}{Logical; whether to apply rolling mean smoothing over enrichment signal. Default is \code{TRUE}.}

\item{window_size}{Integer; sliding window size for smoothing (number of nucleotides or codons depending on \code{mode}). Default is 45.}

\item{retain_cds}{Logical; if \code{TRUE}, restricts plot to CDS (coding sequence) regions of transcripts. Default is \code{TRUE}.}

\item{mode}{Character; plotting resolution, either \code{"codon"} (per 3 nt) or \code{"nt"} (single nucleotide). Default is \code{"codon"}.}

\item{new_signal_range}{Logical; whether to display signal range annotation on the right-top corner of plot. Default is \code{FALSE}.}

\item{enrich_threshold}{Numeric; add a horizontal dashed line indicating enrichment threshold (useful to visually detect high/low enrichment). Default is \code{1}.}

\item{range_x, range_y}{Coordinates used for positioning signal range label when \code{new_signal_range = TRUE}. Default to \code{0.99}, \code{0.98}.}

\item{range_size}{Size of signal range annotation label. Default is \code{4}.}

\item{range_digit}{Integer; number of digits to round displayed max enrichment range. Default is \code{1}.}

\item{exon_line}{A vector specifying color and size (e.g., \code{c("grey", 3)}) for exon structure segments if \code{mode = "nt"}. Default is \code{c("grey", 3)}.}

\item{cds_line}{A vector specifying color and size (e.g., \code{c("grey30", 7)}) for CDS structure line. Default is \code{c("grey30", 7)}.}

\item{facet}{A \code{ggplot2} facet specification, default is \code{facet_grid(sample ~ rname, switch = "y")}.}

\item{nrow, ncol}{Set layout for subplot arrangement when multiple transcripts or samples are included (used in cowplot::plot_grid).}

\item{return_data}{Logical; if \code{TRUE}, return the processed enrichment data (data.frame) used for plotting. Default is \code{FALSE}.}
}
\value{
A \code{ggplot} object showing the enrichment profile plot, or a data.frame when \code{return_data=TRUE}.
}
\description{
This function visualizes the enrichment signal (IP RPM / Total RPM) across transcripts
in a \code{serp} object. It supports sample replication handling, signal smoothing,
display in codon or nucleotide resolution, and graphical customization.
}
\details{
The function uses annotation in the \code{serp} object to generate one or more plots showing enrichment (IP/Total) across exons or CDS regions.

When \code{smooth = TRUE}, rolling mean is computed using \code{zoo::rollsum} with user-defined \code{window_size}.

Samples can be grouped by \code{sample_group}, and replicate merging with SD shading is available.

If \code{return_data = TRUE}, returns a data.frame with values including smoothed counts and enrichment ratio.
}
\examples{
\dontrun{
# Visualize enrichment with smoothing and signal range label
enrichment_plot2(serp_obj, smooth = TRUE, new_signal_range = TRUE)

# Only plot codon positions on CDS without smoothing
enrichment_plot2(serp_obj, smooth = FALSE, retain_cds = TRUE, mode = "codon")

# Return processed data
data <- enrichment_plot2(serp_obj, return_data = TRUE)
}

}
