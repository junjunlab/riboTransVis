% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gene-expression-analysis.R
\name{TE_analysis}
\alias{TE_analysis}
\alias{TE_analysis,ribotrans-method}
\title{Perform Differential Translation Efficiency (TE) Analysis}
\usage{
TE_analysis(object, ...)

\S4method{TE_analysis}{ribotrans}(
  object,
  control_samples = NULL,
  treat_samples = NULL,
  lo2FC = c(-1, 1),
  pval = 0.05,
  norm_by_totalMappedReads = FALSE
)
}
\arguments{
\item{object}{A \code{ribotrans} object that has already been processed by \code{get_counts}.}

\item{...}{Additional arguments (currently unused).}

\item{control_samples}{A character vector of sample names to be used as the control group.}

\item{treat_samples}{A character vector of sample names to be used as the treatment group.}

\item{lo2FC}{A numeric vector of length two specifying the lower and upper
log2 fold change thresholds for classifying significant genes.
Default is \code{c(-1, 1)}, corresponding to a 2-fold change.}

\item{pval}{A numeric value specifying the p-value (not adjusted p-value) cutoff
for classifying significant genes. Default is \code{0.05}.}

\item{norm_by_totalMappedReads}{A logical value. If \code{TRUE}, the function will use
the total mapped reads from the object's library information to calculate and
set custom size factors for DESeq2 normalization. This is highly recommended
if global changes in transcription or translation are expected. If \code{FALSE} (default),
DESeq2's standard median of ratios method will be used.}
}
\value{
A data.frame containing the results of the differential TE analysis.
The data.frame includes columns for base mean, log2 fold change (of TE),
p-value, adjusted p-value (\code{padj}), and gene annotations. An additional \code{type}
column classifies genes into "sigUp", "sigDown", or "nonSig" based on the
provided \code{lo2FC} and \code{pval} thresholds.
}
\description{
This function conducts a differential translation efficiency analysis
using RNA-seq and Ribo-seq data stored within a \code{ribotrans} object. It leverages
the DESeq2 package with an interaction model to distinguish changes in
translation efficiency from changes in transcription.
}
\details{
The core of the analysis is a DESeq2 generalized linear model (GLM)
with the design \code{~ type + condition + type:condition}. In this model:
\itemize{
\item \code{type} distinguishes between RNA-seq and Ribo-seq.
\item \code{condition} models the main effect of the treatment on transcription.
\item \code{type:condition} is the interaction term, which specifically models the
change in Ribo-seq counts that is not explained by the change in RNA-seq
counts. This term represents the change in translation efficiency (TE).
}
The function extracts the results for the interaction term \code{typeRiboseq.conditiontreated}.
}
\examples{
\dontrun{
# Assuming `my_ribo_object` is a valid 'ribotrans' object
# after running `get_counts`.

# Define control and treatment samples
control_samps <- c("WT_rep1", "WT_rep2", "WT_rep3")
treat_samps <- c("KO_rep1", "KO_rep2", "KO_rep3")

# Run TE analysis using default DESeq2 normalization
te_results <- TE_analysis(object = my_ribo_object,
                          control_samples = control_samps,
                          treat_samples = treat_samps)

# View the top results
head(te_results)

# Run TE analysis using normalization by total mapped reads
# This is recommended for experiments with expected global shifts
te_results_custom_norm <- TE_analysis(object = my_ribo_object,
                                      control_samples = control_samps,
                                      treat_samples = treat_samps,
                                      norm_by_totalMappedReads = TRUE,
                                      lo2FC = c(-0.58, 0.58), # 1.5-fold change
                                      pval = 0.05)

# Count number of significantly up/down-regulated genes in TE
table(te_results_custom_norm$type)
}
}
