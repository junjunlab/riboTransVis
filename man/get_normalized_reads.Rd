% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gene-expression-analysis.R
\name{get_normalized_reads}
\alias{get_normalized_reads}
\alias{get_normalized_reads,ribotrans-method}
\title{Calculate Normalized Reads (TPM or RPKM)}
\usage{
get_normalized_reads(object, ...)

\S4method{get_normalized_reads}{ribotrans}(
  object,
  norm_type = c("tpm", "rpkm"),
  norm_by_totalMappedReads = FALSE,
  type = c("rna", "ribo", "te")
)
}
\arguments{
\item{object}{A \code{ribotrans} object that has been processed by \code{get_counts()}
and contains raw count matrices.}

\item{...}{Additional arguments (not currently used).}

\item{norm_type}{A character string specifying the normalization method.
Must be one of \code{"tpm"} (default) or \code{"rpkm"}.}

\item{norm_by_totalMappedReads}{A logical value. If \code{FALSE} (default), the
"per million" scaling factor is derived from the sum of counts assigned to
features in the current analysis (the standard way for TPM). If \code{TRUE}, the
scaling factor is the total number of mapped reads stored in the library
metadata (\code{object@library$mappped_reads}).}

\item{type}{A character vector specifying which data types to process. Can
contain any combination of \code{"rna"}, \code{"ribo"}, and \code{"te"}. For example,
\code{type = c("rna", "ribo", "te")} will calculate and return all three.}
}
\value{
A list containing the requested data frames. The names of the list elements
depend on the \code{norm_type} and \code{type} parameters.
\itemize{
\item \code{tpm.rna} or \code{rpkm.rna}: A data frame with normalized RNA-seq values.
\item \code{tpm.ribo} or \code{rpkm.ribo}: A data frame with normalized Ribo-seq values.
\item \code{te}: A data frame with Translation Efficiency values.
}
Each data frame includes sample columns, followed by gene annotation columns
(e.g., \code{gene_id}, \code{gene_name}, \code{gene_biotype}).
}
\description{
This function calculates normalized expression values (TPM or RPKM) for RNA-seq
and Ribo-seq data stored within a \code{ribotrans} object. It can also compute
Translation Efficiency (TE) based on these normalized values.
}
\details{
The function first checks if raw counts have been generated by \code{get_counts}.
It then proceeds to calculate normalization for the specified data types (\code{rna},
\code{ribo}).

For TPM (Transcripts Per Million) calculation, the formula is:
\enumerate{
\item RPK (Reads Per Kilobase) = \code{raw_counts / (gene_length / 1000)}
\item Per-million scaling factor = \code{sum(RPK)} for all genes in the sample
\item TPM = \code{(RPK / scaling_factor) * 1e6}
}

For RPKM (Reads Per Kilobase of transcript per Million mapped reads), the
formula is:
RPKM = \code{(raw_counts / (gene_length / 1000)) / (total_mapped_reads / 1e6)}

Translation Efficiency (TE) is calculated as the ratio of normalized Ribo-seq
reads to normalized RNA-seq reads (\code{TPM_ribo / TPM_rna} or
\code{RPKM_ribo / RPKM_rna}) for genes common to both datasets.

The method handles data processed via both genome and transcriptome mapping
(\code{object@mapping_type}), adjusting how gene lengths are retrieved accordingly.
}
