% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gene-expression-analysis.R
\name{get_normalized_reads}
\alias{get_normalized_reads}
\alias{get_normalized_reads,ribotrans-method}
\title{Get normalized reads from ribotrans object}
\usage{
get_normalized_reads(object, ...)

\S4method{get_normalized_reads}{ribotrans}(
  object,
  norm_type = c("tpm", "rpkm"),
  type = c("rna", "ribo", "te")
)
}
\arguments{
\item{object}{A \code{ribotrans} object containing RNA and ribosome profiling data}

\item{...}{Additional arguments (currently not used)}

\item{norm_type}{Character string specifying the normalization method.
Options are "tpm" (Transcripts Per Million) or "rpkm" (Reads Per Kilobase Million).
Default is "tpm".}

\item{type}{Character vector specifying which data types to extract.
Options include "rna" (RNA-seq data), "ribo" (ribosome profiling data),
and/or "te" (translation efficiency). Default is all three types.}
}
\value{
A list containing normalized data based on the specified \code{type} parameter:
\describe{
\item{tpm.rna/rpkm.rna}{Data frame with normalized RNA-seq counts and gene annotations}
\item{tpm.ribo/rpkm.ribo}{Data frame with normalized ribosome profiling counts and gene annotations}
\item{te}{Data frame with translation efficiency values (ribosome/RNA ratios) and gene annotations}
}
}
\description{
This function extracts and calculates normalized read counts (TPM or RPKM)
from a ribotrans object for RNA-seq, ribosome profiling, and translation
efficiency data.
}
\details{
The function performs normalization accounting for both gene length and sequencing depth:

\strong{TPM (Transcripts Per Million):}
\enumerate{
\item Calculate RPK (Reads Per Kilobase): count/gene_length_kb
\item Calculate TPM: RPK/sum(RPK) * 10^6
}

\strong{RPKM (Reads Per Kilobase Million):}
\enumerate{
\item Normalize by sequencing depth: count/total_reads * 10^6
\item Normalize by gene length: result/gene_length_kb
}

Translation efficiency (TE) is calculated as the ratio of normalized
ribosome profiling reads to normalized RNA-seq reads for each gene.

For genome-based mapping, gene lengths are extracted from annotation data.
For transcript-based mapping, average transcript lengths are calculated
from the features data.
}
\note{
\itemize{
\item When calculating TE, only genes present in both RNA and ribosome data are included
\item Sample column order is automatically matched between RNA and ribosome data for TE calculation
\item Gene annotations are added based on the mapping type (genome vs transcript)
}
}
\examples{
\dontrun{
# Get TPM normalized data for all types
normalized_data <- get_normalized_reads(ribotrans_obj,
                                       norm_type = "tpm",
                                       type = c("rna", "ribo", "te"))

# Get only RPKM normalized RNA data
rna_rpkm <- get_normalized_reads(ribotrans_obj,
                                norm_type = "rpkm",
                                type = "rna")

# Access specific results
rna_tpm <- normalized_data$tpm.rna
translation_efficiency <- normalized_data$te
}

}
\seealso{
\code{\link[=ribotrans-class]{ribotrans}} for the ribotrans class structure
}
