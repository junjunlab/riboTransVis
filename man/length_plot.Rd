% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualization-QC.R
\name{length_plot}
\alias{length_plot}
\alias{length_plot,ribotrans-method}
\title{Plot Read Length Distribution or Frame Periodicity for ribotrans Objects}
\usage{
length_plot(object, ...)

\S4method{length_plot}{ribotrans}(
  object,
  read_length = c(20, 35),
  merge_rep = FALSE,
  text_size = 4,
  col_width = 0.9,
  col_color = "grey30",
  add_periodicity_label = TRUE,
  labely_extend = 0.05,
  facet = ggplot2::facet_wrap(~sample, scales = "free"),
  return_data = FALSE,
  type = c("length", "frame_length")
)
}
\arguments{
\item{object}{A \code{ribotrans} object. It must contain a \code{summary_info}
slot/data.frame with columns \code{sample}, \code{sample_group}, \code{qwidth},
\code{count}, \code{pos}, \code{mstart}, and \code{mstop}.}

\item{...}{Additional arguments (currently unused).}

\item{read_length}{Numeric vector of length two. Read length range
(inclusive) to include in the plot. Default is \code{c(20, 35)}.}

\item{merge_rep}{Logical. If \code{TRUE}, replicates (same \code{sample_group})
are aggregated by mean counts. Default is \code{FALSE}.}

\item{text_size}{Numeric. Text size for periodicity labels. Default is 4.}

\item{col_width}{Numeric. Width of the bars in the plot. Default is 0.9.}

\item{col_color}{Character. Fill color of bars when \code{type = "length"}.
Default is \code{"grey30"}.}

\item{add_periodicity_label}{Logical. If \code{TRUE} and
\code{type = "frame_length"}, adds the percentage of reads in the dominant
frame as text labels. Default is \code{TRUE}.}

\item{labely_extend}{Numeric. Proportion by which to extend the y-coordinate
of periodicity labels above the top of their bars. Default is 0.05.}

\item{facet}{A ggplot2 faceting specification, e.g.
\code{ggplot2::facet_wrap(~sample, scales = "free")}.
Default is \code{ggplot2::facet_wrap(~sample, scales = "free")}.}

\item{return_data}{Logical. If \code{FALSE} (default), returns a \code{ggplot}
object. If \code{TRUE}, returns the processed data.frame used for plotting.}

\item{type}{Character string specifying the plot type.
\code{"length"} for read length distribution,
\code{"frame_length"} for frame-resolved counts.
Default is \code{c("length", "frame_length")}.}
}
\value{
If \code{return_data = FALSE}, a \code{ggplot} object. If
\code{return_data = TRUE}, a data.frame with columns corresponding to
the selected \code{type} and grouping variables.
}
\description{
This function generates a ggplot visualization of read length distribution
or frame-specific read counts (with optional periodicity labels) from a
\code{ribotrans} object. It can also aggregate replicates and/or return the
underlying summary data.
}
\examples{
\dontrun{
## Assuming rt is a valid ribotrans object:
# Simple length distribution plot
length_plot(rt)

# Frame-resolved plot, merging replicates and returning data
df <- length_plot(rt,
type = "frame_length",
merge_rep = TRUE,
return_data = TRUE)
}

}
\seealso{
\code{\link[ggplot2]{ggplot}}, \code{\link[dplyr]{group_by}},
\code{\link[fastplyr]{f_summarise}}, \code{\link[methods]{setGeneric}}
}
