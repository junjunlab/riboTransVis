% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualization-QC.R
\name{length_plot}
\alias{length_plot}
\alias{length_plot,ribotrans-method}
\title{Generate Length Distribution Plot}
\usage{
length_plot(object, ...)

\S4method{length_plot}{ribotrans}(
  object,
  read_length = c(20, 35),
  merge_rep = FALSE,
  text_size = 2.5,
  add_periodicity_label = TRUE,
  labely_extend = 0.05,
  return_data = FALSE,
  type = c("length", "frame_length")
)
}
\arguments{
\item{object}{A \code{ribotrans} object that contains summary read count information.}

\item{...}{Additional arguments passed to class-specific methods.}

\item{read_length}{A numeric vector of length 2 (default: \code{c(20, 35)}). Defines the range of read lengths to visualize.}

\item{merge_rep}{Logical. Whether to merge replicate samples by \code{sample_group}. Default is \code{FALSE}.}

\item{text_size}{Numeric (default: \code{2.5}). Specifies the font size for periodicity labels, applicable when \code{type = "frame_length"}.}

\item{add_periodicity_label}{Logical (default: \code{TRUE}). If \code{TRUE}, adds periodicity percentage labels to the plot (only for \code{type = "frame_length"}).}

\item{labely_extend}{A numeric proportion to extend the y-position of periodicity labels above bars
(default: 0.05).}

\item{return_data}{Logical (default: \code{FALSE}). If \code{TRUE}, returns the processed data frame instead of a plot.}

\item{type}{Character string, either \code{"length"} (default) or \code{"frame_length"}.
\itemize{
\item \code{"length"}: Displays a bar plot showing the distribution of read lengths.
\item \code{"frame_length"}: Displays a bar plot with frame-periodicity information, highlighting the reading frame (0, 1, 2).
}}
}
\value{
A ggplot object representing the length distribution of reads.

A \code{ggplot2} object showing the read length distribution or a processed data frame if \code{return_data = TRUE}.
}
\description{
This generic function generates a length distribution plot for sequencing reads.

The \code{length_plot} function visualizes the distribution of read lengths in a Ribo-seq dataset.
It can either show the total counts of different read lengths (\code{type = "length"})
or display frame-periodicity information (\code{type = "frame_length"}).
}
\details{
\itemize{
\item If \code{type = "length"}, the function summarizes read counts by length.
\item If \code{type = "frame_length"}, the function calculates frame-periodicity and shows the proportion of reads mapped to each frame.
\item Frame-periodicity is computed as: \emph{\strong{percentage of reads in frame-0 relative to all frames}}.
\item Reads outside annotated coding regions (\code{mstart !=0} or \code{mstop !=0}) are analyzed for periodicity.
}
}
\examples{
\dontrun{
data(ribo_obj)  # Assume ribo_obj is a 'ribotrans' object

# Plot read length distribution
length_plot(ribo_obj, read_length = c(25, 30), type = "length")

# Plot frame-periodicity with periodicity labels
length_plot(ribo_obj, type = "frame_length", add_periodicity_label = TRUE)

# Retrieve processed data
df <- length_plot(ribo_obj, return_data = TRUE, type = "frame_length")
head(df)
}

}
\seealso{
\code{\link[ggplot2:geom_bar]{ggplot2::geom_col()}}, \code{\link[ggplot2:facet_wrap]{ggplot2::facet_wrap()}}, \code{\link[dplyr:mutate]{dplyr::mutate()}}, \code{\link[scales:label_log]{scales::label_log()}}
}
