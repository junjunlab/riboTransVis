% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualization-methods.R
\name{trans_plot}
\alias{trans_plot}
\alias{trans_plot,ribotrans-method}
\title{Plot RNA-seq and Ribosome Occupancy along Transcripts}
\usage{
trans_plot(object, ...)

\S4method{trans_plot}{ribotrans}(
  object,
  selected_id = NULL,
  type = c("ribo", "rna", "ribo_rna", "scaled_ribo"),
  layer = c("line", "col"),
  col_alpha = 1,
  sample_order = NULL,
  facet_layer = ggplot2::facet_grid(sample ~ rname, switch = "y"),
  sep_mer_sample = FALSE,
  new_signal_range = TRUE,
  position_mode = c("nt", "codon"),
  range_x = 0.98,
  range_y = 0.98,
  range_size = 4,
  range_digit = 1,
  scale_factor = 1,
  utr_width = 1,
  cds_width = 3,
  utr_col = "grey",
  cds_col = "grey30",
  nrow = NULL,
  ncol = NULL
)
}
\arguments{
\item{object}{A \code{ribotrans} object. Must have properly populated occupancy slots (e.g., \code{ribo_occupancy}, \code{RNA_coverage}, etc.) and transcript \code{features}.}

\item{...}{Additional arguments (currently unused).}

\item{selected_id}{Character vector. A list of transcript IDs to plot. If \code{NULL} (default), all transcripts for the current gene will be plotted.}

\item{type}{Character. The type of signal to plot: one of \code{"ribo"}, \code{"rna"}, \code{"ribo_rna"}, or \code{"scaled_ribo"}. Default: \code{"ribo"}.}

\item{layer}{Layer geometry: \code{"line"} (default) for \code{geom_path()} curves, or \code{"col"} for \code{geom_col()} bar charts.}

\item{col_alpha}{Numeric in c(0,1), transparency for the bars when
\code{layer = "col"}. Default: \code{1}.}

\item{sample_order}{Character vector. Optional. The desired order of samples in the facet display.}

\item{facet_layer}{A ggplot2 facet object (e.g., \code{facet_grid()}) for organizing sample/transcript panels. Default: \code{facet_grid(sample ~ rname, switch = "y")}.}

\item{sep_mer_sample}{Logical. If \code{TRUE}, merged sample display is combined with individual sample facets. Default: \code{FALSE}.}

\item{new_signal_range}{Logical. Whether to annotate each panel with the signal range. Requires package \pkg{ggpp}. Default: \code{TRUE}.}

\item{position_mode}{Character. Plot resolution: \code{"nt"} (nucleotide) or \code{"codon"} (amino acid/codon level). Default: \code{"nt"}.}

\item{range_x}{X position (normalized 0–1) for the signal range label. Default: 0.98.}

\item{range_y}{Y position (normalized 0–1) for the signal range label. Default: 0.98.}

\item{range_size}{Numeric. Font size for signal range label. Default: 4.}

\item{range_digit}{Integer. Digits to round signal range values for annotation. Default: 1.}

\item{scale_factor}{Numeric. Scaling factor for RNA signal when comparing ribo and RNA together (used only when \code{type = "ribo_rna"}). Default: 1.}

\item{utr_width}{Line width for 5'/3' UTR region annotations respectively. Default: \code{1} for UTR.}

\item{cds_width}{Line width for CDS region annotations respectively. Default: \code{3} for CDS.}

\item{utr_col}{Colors used to annotate UTR in \code{ggside} alignment strip. Default: \code{"grey"}.}

\item{cds_col}{Colors used to annotate CDS in \code{ggside} alignment strip. Default: \code{"grey30"}.}

\item{nrow}{Number of rows in the final layout when multiple transcripts are plotted. Passed to \code{cowplot::plot_grid()}.}

\item{ncol}{Number of columns in the final layout when multiple transcripts are plotted. Passed to \code{cowplot::plot_grid()}.}
}
\value{
A \code{ggplot} object (consisting of multiple panels combined using \pkg{cowplot}); each panel represents one transcript. Plot can show either separate or merged replicate signals.
}
\description{
Visualizes ribosome footprint occupancy or RNA coverage across transcript coordinates for a given gene using data stored in a \code{ribotrans} object. This function supports various data layers (e.g., IP, RNA, scaled ribo), replicate visualization, structural annotations, and codon/nucleotide views.
}
\details{
This method supports four types of data display:

\describe{
\item{"ribo"}{Ribosome footprint data from \code{ribo_occupancy} slot}
\item{"rna"}{Total RNA coverage data from \code{RNA_coverage} slot}
\item{"ribo_rna"}{Overlaid ribo + scaled RNA signals}
\item{"scaled_ribo"}{Pre-standardized/normalized ribo signal from \code{scaled_occupancy}}
}

Transcript structure data is pulled from the \code{features} slot using the gene of interest (\code{object@gene_name}). For each transcript, smoothed signal trajectories across positions are displayed, with optional CDS annotation and signal range label.

If \code{sep_mer_sample = TRUE}, individual samples and merged signal (e.g., mean profile) will be plotted together. Structural annotations such as CDS length and UTRs are visualized using \pkg{ggside}'s \code{geom_xsidesegment()}.
}
\examples{
\dontrun{
# Plot ribosome occupancy with default settings
trans_plot(ribotrans_obj)

# Plot RNA signal in bar chart format at nucleotide resolution
trans_plot(ribotrans_obj, type = "rna", layer = "col", position_mode = "nt")

# Overlay Ribo & RNA with scaling + CDS annotation at codon level
trans_plot(ribotrans_obj, type = "ribo_rna", position_mode = "codon", scale_factor = 0.3)
}

}
\seealso{
\code{\link{get_occupancy}}, \code{\link{get_coverage}}, \code{\link{get_scaled_occupancy}}
}
