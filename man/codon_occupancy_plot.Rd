% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/codon-occupancy.R
\name{codon_occupancy_plot}
\alias{codon_occupancy_plot}
\alias{codon_occupancy_plot,ribotrans-method}
\title{Codon Occupancy Plot}
\usage{
codon_occupancy_plot(object, ...)

\S4method{codon_occupancy_plot}{ribotrans}(
  object,
  merge_rep = FALSE,
  cds_fa = NULL,
  do_offset_correct = FALSE,
  position_shift = 0,
  plot_abbreviation = FALSE,
  facet = TRUE,
  return_data = FALSE
)
}
\arguments{
\item{object}{An object of class \code{ribotrans}, containing ribosome profiling data.}

\item{...}{Additional arguments (currently unused).}

\item{merge_rep}{Logical. Whether to merge replicate samples by \code{sample_group}. Default is \code{FALSE}.}

\item{cds_fa}{Character. The path to a FASTA file containing CDS sequences.}

\item{do_offset_correct}{Logical. If \code{TRUE}, performs \strong{offset correction}
using \code{do_offset_correction()}. \strong{Default}: \code{FALSE}.}

\item{position_shift}{Integer defining how much to adjust \strong{ribosome footprint positions}
during offset correction. \strong{Default}: \code{0}.}

\item{plot_abbreviation}{Logical. If \code{TRUE}, uses amino acid abbreviations instead of codons as x-axis labels. Default is \code{FALSE}.}

\item{facet}{Logical. If \code{TRUE}, the plot is faceted by amino acid groups. Default is \code{TRUE}.}

\item{return_data}{Logical. If \code{TRUE}, returns a data frame with codon occupancy data instead of generating a plot. Default is \code{FALSE}.}
}
\value{
If \code{return_data = FALSE}, returns a ggplot2 object (bar plot of codon occupancy).
If \code{return_data = TRUE}, returns a data frame with the following columns:
\itemize{
\item \code{sample} - Sample identifier.
\item \code{codon_seq} - Codon sequence.
\item \code{AminoAcid} - Full name of the amino acid.
\item \code{Abbreviation3} - Three-letter amino acid abbreviation.
\item \code{Abbreviation1} - One-letter amino acid abbreviation.
\item \code{reloccup} - Relative codon occupancy.
}
}
\description{
This function calculates the codon occupancy for ribosome profiling data and generates a bar plot.
}
\details{
Codon occupancy is calculated based on normalized ribosome profiling read coverage. The function:
\enumerate{
\item Filters out invalid CDS data.
\item Computes average read counts per codon.
\item Loads CDS sequences and extracts codon-level information.
\item Merges ribosome occupancy data with codon identity.
\item Generates a relative codon occupancy profile.
\item Optionally, visualizes codon occupancy as a bar plot.
}
}
\examples{
\dontrun{
codon_ocuupancy_plot(object = my_ribotrans,
                     cds_fa = "cds.fa",
                     plot_abbreviation = TRUE,
                     facet = TRUE)
}

}
