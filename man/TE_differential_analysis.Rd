% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gene-expression-analysis.R
\name{TE_differential_analysis}
\alias{TE_differential_analysis}
\alias{TE_differential_analysis,ribotrans-method}
\title{Differential Translation Efficiency (TE) Analysis}
\usage{
TE_differential_analysis(object, ...)

\S4method{TE_differential_analysis}{ribotrans}(
  object,
  pkg = c("riborex", "xtail"),
  method = c("DESeq2", "edgeR", "edgeRD", "Voom"),
  control_samples = NULL,
  treat_samples = NULL,
  min_count = 1,
  lo2FC = c(-1, 1),
  pval = 0.05
)
}
\arguments{
\item{object}{A \code{ribotrans} object containing count matrices for RNA-seq and RPF,
plus relevant annotation. Must have \code{object@mapping_type} set to
"genome" or "transcriptome".}

\item{...}{Additional arguments (currently unused).}

\item{pkg}{A character string, either "riborex" or "xtail", indicating which package
to use for differential TE analysis.}

\item{method}{Character string specifying the statistical engine to use when
\code{pkg = "riborex"}. Possible values are "DESeq2", "edgeR", "edgeRD", or "Voom".}

\item{control_samples}{A character vector of sample names that are considered controls
(must be column names in \code{rna_mtx} and \code{ribo_mtx}).}

\item{treat_samples}{A character vector of sample names that are considered treated
(must be column names in \code{rna_mtx} and \code{ribo_mtx}).}

\item{min_count}{A numeric threshold indicating the minimum mean count required
for a gene to be included in the analysis (default is 1).}

\item{lo2FC}{A numeric vector of length 2 specifying the log2 fold change thresholds
for calling significant up/down (default is c(-1, 1)).}

\item{pval}{A numeric value specifying the p-value cutoff for significance (default is 0.05).}
}
\value{
A list with two components:
\item{deg_raw}{Raw differential expression results returned by riborex or xtail.}
\item{deg_anno}{Results data frame with columns for gene annotation (if genome-mapped)
and a "type" column indicating significance status: "sigUp", "sigDown", or "nonSig".}
}
\description{
This function performs differential translation efficiency analysis using either
the riborex or xtail package. It compares two conditions (control vs. treated) at
both RNA-seq and Ribo-seq levels, determining changes in translational efficiency
and identifying significantly up- or down-regulated genes.
}
\details{
\enumerate{
\item If \code{pkg = "riborex"}, the function uses \code{\link[riborex]{riborex}}
to assess differential expression on the matched RNA and RPF (ribosome-protected
fragment) counts. This approach can use multiple back-ends such as DESeq2, edgeR,
or voom-limma (as specified in \code{method}) to detect significantly changed transcripts.
\item If \code{pkg = "xtail"}, the function uses xtail to directly compute
changes in translational efficiency (log2FC_TE_final) and associated p-values for each gene.
Genes are then annotated with a simple significance category (sigUp, sigDown, or nonSig)
based on log fold-change thresholds (\code{lo2FC}) and p-value threshold (\code{pval}).
\item The input requires that the \code{ribotrans} object contains:
• RNA-seq and RPF count matrices (in \code{object@counts$rna} and \code{object@counts$rpf})
• Metadata for genome-mapped counts (e.g. \code{object@counts$rna$annotation} and
\code{object@counts$rpf$annotation}) if \code{object@mapping_type == "genome"}
\item The function returns a list containing raw differential expression results as well as
annotation-augmented results, marking significant up/down changes.
}
}
\examples{
\dontrun{
  # Suppose 'my_ribotrans_obj' has been populated with RNA-seq and RPF count data
  # for several control and treated samples.
  te_results <- TE_differential_analysis(
    object = my_ribotrans_obj,
    pkg = "riborex",
    method = "DESeq2",
    control_samples = c("ctrl_1","ctrl_2"),
    treat_samples = c("trt_1","trt_2"),
    min_count = 10,
    lo2FC = c(-1, 1),
    pval = 0.01
  )

  # Check significant upregulated genes
  subset(te_results$deg_anno, type == "sigUp")
}

}
