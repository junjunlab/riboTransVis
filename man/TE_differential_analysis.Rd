% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gene-expression-analysis.R
\name{TE_differential_analysis}
\alias{TE_differential_analysis}
\alias{TE_differential_analysis,ribotrans-method}
\title{Translation Efficiency Differential Expression Analysis}
\usage{
TE_differential_analysis(object, ...)

\S4method{TE_differential_analysis}{ribotrans}(
  object,
  method = c("DESeq2", "edgeR", "edgeRD", "Voom"),
  control_samples = NULL,
  treat_samples = NULL,
  min_count = 1,
  lo2FC = c(-1, 1),
  pval = 0.05
)
}
\arguments{
\item{object}{A \code{ribotrans} object. The count data must be generated beforehand using \code{get_counts()}.}

\item{...}{Additional arguments (currently unused).}

\item{method}{Character string indicating which testing engine to use. Options are:
\describe{
\item{\code{"DESeq2"}}{DESeq2 framework}
\item{\code{"edgeR"}}{edgeR framework (default)}
\item{\code{"edgeRD"}}{edgeR with dispersion smoothing (DEG with replicates)}
\item{\code{"Voom"}}{Limma-Voom approach}
}}

\item{control_samples}{Character vector of sample names corresponding to control group.}

\item{treat_samples}{Character vector of sample names corresponding to treatment group.}

\item{min_count}{Minimum mean count threshold (default is 1) to filter low-expression genes.}

\item{lo2FC}{Numeric vector of length 2 indicating the lower and upper threshold for log2 fold change.
Default is \code{c(-1, 1)}.}

\item{pval}{Numeric scalar. The significance threshold for p-value cutoff (default = 0.05).}
}
\value{
A named list with two elements:
\describe{
\item{\code{deg_raw}}{Raw result table returned by \pkg{riborex}, including log-fold changes and p-values.}
\item{\code{deg_anno}}{Annotated result data frame with gene symbols, biotypes, and significance label (\code{type}): \code{"sigUp"}, \code{"sigDown"}, \code{"nonSig"}.}
}
}
\description{
Performs differential analysis of translation efficiency (TE) between treatment and control
conditions using RNA-seq and Ribo-seq paired count data from a \code{ribotrans} object. Internally
uses the \pkg{riborex} package to model TE changes across experimental groups using selected statistical engines.
}
\details{
The function first extracts count matrices from RNA and Ribo fractions, aligns their gene rows,
and then runs differential analysis using \code{riborex()} with the selected statistical engine.
Genes are classified as significantly up- or down-regulated based on \code{lo2FC} and \code{pval} thresholds.
}
\examples{
\dontrun{
# Assume `obj` is a ribotrans object with RNA and Ribo counts.
# Samples "ctrl1", "ctrl2" as control; "trt1", "trt2" as treatment.
res <- TE_differential_analysis(
  object = obj,
  method = "edgeR",
  control_samples = c("ctrl1", "ctrl2"),
  treat_samples = c("trt1", "trt2"),
  min_count = 5,
  lo2FC = c(-1.5, 1.5),
  pval = 0.01
)

# View annotated differential TE results
head(res$deg_anno)
table(res$deg_anno$type)
}

}
\seealso{
\code{\link[riborex]{riborex}}, \code{\link{get_counts}}
}
