% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/serp-binding-peaks-detection.R
\name{find_strong_peaks}
\alias{find_strong_peaks}
\alias{find_strong_peaks,serp-method}
\title{Find Strong Binding Peaks from SeRP Data}
\usage{
find_strong_peaks(object, ...)

\S4method{find_strong_peaks}{serp}(
  object,
  do_offset_correct = FALSE,
  position_shift = 0,
  min_counts = 32,
  read_length = c(25, 35),
  smooth = TRUE,
  window_size = 45,
  enrichment_threshold = 1.5,
  binding_width = 15,
  mode = c("nt", "codon")
)
}
\arguments{
\item{object}{A \code{serp} object containing summarized read alignment data, sample metadata, and transcript annotations.}

\item{...}{Additional arguments (currently unused).}

\item{do_offset_correct}{Logical. Whether to apply P-site offset correction. Default is \code{FALSE}.}

\item{position_shift}{Integer. Fixed offset to apply when \code{do_offset_correct = TRUE}. Default is \code{0}.}

\item{min_counts}{Integer. Minimum total count required for a gene in a sample to be included in the analysis. Default is \code{32}.}

\item{read_length}{Integer vector of length 2. Specifies the range of read lengths to include in the analysis. Default is \code{c(25, 35)}.}

\item{smooth}{Logical. Whether to apply signal smoothing using a rolling sum of counts. Default is \code{TRUE}.}

\item{window_size}{Integer. Size of the rolling window used for smoothing. Only used if \code{smooth = TRUE}. Default is \code{45}.}

\item{enrichment_threshold}{Numeric. Minimum enrichment ratio (IP / total) required to consider a region as a strong peak. Default is \code{1.5}.}

\item{binding_width}{Integer. Minimum width (in nucleotides or codons) of a contiguous enriched region to be considered a peak. Default is \code{15}.}

\item{mode}{Character. Output resolution of the coordinates. Either \code{"nt"} (nucleotide-level) or \code{"codon"} (codon-level). Default is \code{"nt"}.}
}
\value{
A \code{data.frame} containing the detected strong binding peaks with the following columns:
\item{sample}{Sample identifier}
\item{sample_group}{Group corresponding to the sample}
\item{rname}{Transcript or gene name}
\item{start}{Start position of the peak (in nt or codon)}
\item{end}{End position of the peak (in nt or codon)}
\item{mean_ratio}{Average enrichment ratio in the peak window}
\item{binding_width}{Width of the binding peak (number of positions)}
}
\description{
Identifies strong signal peaks in selective ribosome profiling (SeRP) data by comparing the IP (immunoprecipitated) and total samples. This function can optionally apply P-site offset correction, smooth read signal, calculate enrichment ratio, filter low-count features, and detect enriched regions (peaks) within coding sequences (CDSs).
}
\details{
The function compares RPM-normalized read counts from total and IP libraries. It identifies regions where the enrichment ratio (IP/total) exceeds a given threshold for at least a minimum number of nucleotides (or codons). Optional signal smoothing via RcppRoll can help reduce local noise.

When \code{mode = "codon"}, the data is downsampled to codon resolution after peak calling, with positions divided by 3 (frame-shifted if needed).

Read filtering is applied based on read length and minimum count thresholds.

Offset correction (if enabled) aligns reads based on inferred P-site positions.
}
\examples{
\dontrun{
peaks <- find_strong_peaks(object = my_serp,
do_offset_correct = TRUE,
position_shift = 12,
min_counts = 32,
read_length = c(25, 35),
smooth = TRUE,
window_size = 45,
enrichment_threshold = 1.5,
binding_width = 15,
mode = "codon")
head(peaks)
}

}
\seealso{
\code{\link{do_offset_correction}}, \code{\link{serp-class}}
}
