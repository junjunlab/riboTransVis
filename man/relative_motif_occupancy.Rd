% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/relative-motif-occupancy.R
\name{relative_motif_occupancy}
\alias{relative_motif_occupancy}
\alias{relative_motif_occupancy,ribotrans-method}
\title{Calculate Relative Motif Occupancy in Ribo-seq Data}
\usage{
relative_motif_occupancy(object, ...)

\S4method{relative_motif_occupancy}{ribotrans}(
  object,
  merge_rep = FALSE,
  cds_fa = NULL,
  do_offset_correct = FALSE,
  position_shift = 0,
  search_type = c("amino", "codon"),
  exclude_length = c(45, 45),
  min_counts = 64,
  motif_pattern = "PPP",
  motif_upstream = 50,
  motif_downstream = 50
)
}
\arguments{
\item{object}{An object of class \code{ribotrans} that contains experimental data, including
ribosome profiling information.}

\item{...}{Additional arguments (currently unused).}

\item{merge_rep}{Logical. Whether to merge replicate samples by \code{sample_group}. Default is \code{FALSE}.}

\item{cds_fa}{A character string specifying the file path to a FASTA file containing
the nucleotide sequences of coding regions (CDS).}

\item{do_offset_correct}{Logical. If \code{TRUE}, performs \strong{offset correction}
using \code{do_offset_correction()}. \strong{Default}: \code{FALSE}.}

\item{position_shift}{Integer defining how much to adjust \strong{ribosome footprint positions}
during offset correction. \strong{Default}: \code{0}.}

\item{search_type}{Search mode, either \code{"amino"} (default) to search \strong{protein motifs}
or \code{"codon"} to search \strong{specific codon triplets}.}

\item{exclude_length}{A numeric vector of length two specifying the number of nucleotides
to exclude from the start and end of the CDS to avoid boundary effects. Default is \code{c(45, 45)}.}

\item{min_counts}{A numeric value indicating the minimum read counts required for a transcript
to be included in the analysis. Default is \code{64}.}

\item{motif_pattern}{A character vector specifying one or more amino acid motifs to be analyzed.}

\item{motif_upstream}{An integer specifying the number of nucleotides upstream of the motif
to consider for analysis. Default is \code{50}.}

\item{motif_downstream}{An integer specifying the number of nucleotides downstream of the motif
to consider for analysis. Default is \code{50}.}
}
\value{
A \code{data.frame} containing the relative occupancy of ribosomes around each motif.
The columns include:
\itemize{
\item \code{sample} - The sample name.
\item \code{motif} - The identified motif.
\item \code{dist} - The relative nucleotide position from the motif.
\item \code{value} - The unnormalized count of ribosome footprints.
\item \code{avg_val} - The normalized translation occupancy (relative to transcript averages).
}
}
\description{
This function calculates the relative ribosome occupancy around specific
motifs in coding sequences (CDS) using Ribo-seq data.
}
\details{
\itemize{
\item This function first \strong{filters and extracts coding sequences from input FASTA (\code{cds_fa})}
and translates sequences into \strong{protein sequences} using \code{Biostrings::translate()}.
\item If \code{search_type = "amino"}, the function searches \strong{protein motifs} (e.g., \code{"PPP"} for Proline triplets).
\item If \code{search_type = "codon"}, the function searches \strong{specific codons} (e.g., \code{"CCG"} for Proline in codon format).
\item Only \strong{motifs occurring in the correct reading frame} are counted.
\item \strong{Ribosome occupancy} is calculated in a \strong{fixed window (\code{motif_upstream} & \code{motif_downstream})}
around the motif center.
\item Transcripts with \strong{low read counts (< \code{min_counts}) are excluded} to reduce noise.
}
}
\examples{
\dontrun{
result <- relative_motif_occupancy(
  object = ribo_data,
  search_type = "amino",
  cds_fa = "cds_sequences.fasta",
  motif_pattern = c("PPP", "PPAP"),
  motif_upstream = 100,
  motif_downstream = 100,
  min_counts = 50
)
head(result)
}

}
