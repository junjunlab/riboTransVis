% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gene-expression-analysis.R
\name{get_counts}
\alias{get_counts}
\alias{get_counts,ribotrans-method}
\title{Get Read Counts for RNA-seq and Ribo-seq}
\usage{
get_counts(object, ...)

\S4method{get_counts}{ribotrans}(
  object,
  GTF_attrType.extra = c("gene_name", "gene_biotype"),
  rna_feature = "exon",
  ribo_feature = "CDS",
  nThreads = 1
)
}
\arguments{
\item{object}{A \code{\link{ribotrans}} object, which contains metadata and paths to BAM files.}

\item{...}{Additional arguments (currently unused).}

\item{GTF_attrType.extra}{A character vector specifying extra gene attributes (beyond the default \code{gene_id})
to be included from the GTF file. Typically \code{c("gene_name","gene_biotype")}.}

\item{rna_feature}{The annotation feature type to use for counting RNA-seq reads
(e.g. \code{"exon"}). Only used if \code{object@mapping_type} is \code{"genome"}.}

\item{ribo_feature}{The annotation feature type to use for counting Ribo-seq reads
(e.g. \code{"CDS"}). Only used if \code{object@mapping_type} is \code{"genome"}.}

\item{nThreads}{Number of threads for parallel processing (default is 1).}
}
\value{
The input \code{object} (of class \code{\link{ribotrans}}) is returned,
with a new slot \code{object@counts} containing count matrices for RNA-seq and
Ribo-seq data. This slot is a list with elements:
\describe{
\item{\code{rpf}}{Counts and summary info for Ribo-seq data.}
\item{\code{rna}}{Counts and summary info for RNA-seq data.}
}
}
\description{
Uses Rsubread::featureCounts (for genome-mapped data) or Rsamtools::idxstatsBam / Rsamtools::scanBam
(for transcriptome-mapped data) to quantify gene-level counts of RNA-seq and Ribo-seq reads.
}
\details{
\enumerate{
\item If \code{object@mapping_type} is "genome", the function calls
\code{Rsubread::featureCounts()} to summarize alignments for:
\itemize{
\item RNA-seq: exons by default (\code{rna_feature = "exon"}).
\item Ribo-seq: coding sequences (\code{ribo_feature = "CDS"}).
}
The GTF file path is taken from \code{object@gtf_path}, and extra gene attributes
such as \code{gene_name} and \code{gene_biotype} are captured if present.
\item If \code{object@mapping_type} is "transcriptome", the function performs:
\itemize{
\item \code{idxstatsBam()} to get rapid counts for RNA-seq aligned to transcript-level BAMs,
then uses string parsing and grouping to merge counts by gene_name.
\item \code{scanBam()} to extract read positions for Ribo-seq alignments,
then intersects them with known mRNA regions (\code{object@features}),
aggregating by \code{mstart} and \code{mstop}.
}
}

After counting, the function stores two separate list entries in \code{object@counts}:
\code{$rpf} for Ribo-seq data and \code{$rna} for RNA-seq data. Each contains
\code{$counts}, \code{$annotation}, \code{$targets}, and \code{$stat}, when available.
}
\examples{
\dontrun{
  # Assuming 'my_ribotrans_obj' is a valid ribotrans object
  # and its BAM files plus GTF path have already been specified:
  my_ribotrans_obj <- get_counts(
    my_ribotrans_obj,
    GTF_attrType.extra = c("gene_name","gene_biotype"),
    rna_feature = "exon",
    ribo_feature = "CDS",
    nThreads = 4
  )

  # Then, you can inspect the counts:
  head(my_ribotrans_obj@counts$rna$counts)
  head(my_ribotrans_obj@counts$rpf$counts)
}

}
