% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualization-methods.R
\name{genome_trans_plot}
\alias{genome_trans_plot}
\alias{genome_trans_plot,ribotrans-method}
\title{Plot Transcript-level Ribosome and RNA Coverage with Gene Structure}
\usage{
genome_trans_plot(object, ...)

\S4method{genome_trans_plot}{ribotrans}(
  object,
  selected_id = NULL,
  type = c("ribo", "rna", "ribo_rna"),
  layer = c("col", "line"),
  col_alpha = 1,
  sample_order = NULL,
  facet_layer = ggplot2::facet_grid(sample ~ rname, switch = "y"),
  sep_mer_sample = FALSE,
  new_signal_range = FALSE,
  collapse_structure = FALSE,
  range_x = 0.9,
  range_y = 0.9,
  range_size = 4,
  range_digit = 1,
  scale_factor = 1,
  utr_width = 1,
  cds_width = 3,
  background_line = c("black", 0.25),
  exon_line = c("#003399", 1),
  cds_line = c("#003399", 3),
  structure_panel_height = 0.2
)
}
\arguments{
\item{object}{A \code{ribotrans} object. Must contain the results of
\code{get_occupancy()} for ribosome data and/or \code{get_coverage()}
for RNA data, as well as the GTF annotation for the target gene stored
in \code{@gtf_data}.}

\item{...}{Additional arguments (currently unused).}

\item{selected_id}{Character vector of transcript IDs to include in the plot.
Default: \code{NULL}, in which case all transcripts for the gene are shown.}

\item{type}{Character; one of \code{"ribo"}, \code{"rna"} or
\code{"ribo_rna"}. Specifies whether to plot only ribosome occupancy,
only RNA coverage, or both. Default: \code{c("ribo", "rna", "ribo_rna")}
(i.e. \code{"ribo"}).}

\item{layer}{Character; one of \code{"col"} or \code{"line"}. Use bar plots
(\code{"col"}) or line plots (\code{"line"}) for the signal.
Default: \code{c("col", "line")} (i.e. \code{"col"}).}

\item{col_alpha}{Numeric in c(0,1), transparency for the bars when
\code{layer = "col"}. Default: \code{1}.}

\item{sample_order}{Optional character vector specifying the desired order
of samples in the facets. If \code{NULL}, the original order in the data
is retained. Default: \code{NULL}.}

\item{facet_layer}{A \code{ggplot2} facet specification (e.g.
\code{ggplot2::facet_grid}). Default:
\code{ggplot2::facet_grid(sample ~ rname, switch = "y")}.}

\item{sep_mer_sample}{Logical; if \code{TRUE}, displays both the merged
signal and individual samples side by side. Default: \code{FALSE}.}

\item{new_signal_range}{Logical; if \code{TRUE}, annotates a text label
showing the range of the plotted signal at position (\code{range_x},
\code{range_y}). Default: \code{FALSE}.}

\item{collapse_structure}{Logical; if \code{TRUE}, collapses all transcript
structures into a single line. Otherwise each transcript is plotted on
its own horizontal line. Default: \code{FALSE}.}

\item{range_x}{Numeric in c(0,1), x‐coordinate (in NPC units) of the range
annotation. Default: \code{0.9}.}

\item{range_y}{Numeric in c(0,1), y‐coordinate (in NPC units) of the range
annotation. Default: \code{0.9}.}

\item{range_size}{Numeric, text size of the range annotation. Default:
\code{4}.}

\item{range_digit}{Integer, number of digits to round the maximum signal
value for the label. Default: \code{1}.}

\item{scale_factor}{Numeric factor to scale the RNA coverage when
\code{type = "ribo_rna"}. Default: \code{1}.}

\item{utr_width}{Numeric, relative width of UTR segments (currently unused).
Default: \code{1}.}

\item{cds_width}{Numeric, relative width of CDS segments (currently unused).
Default: \code{3}.}

\item{background_line}{A length-2 vector \code{c(color, size)} controlling
the color and line width of the transcript backbone.
Default: \code{c("black", 0.25)}.}

\item{exon_line}{A length-2 vector \code{c(color, size)} controlling exon
segment styling. Default: \code{c("#003399", 1)}.}

\item{cds_line}{A length-2 vector \code{c(color, size)} controlling CDS
segment styling. Default: \code{c("#003399", 3)}.}

\item{structure_panel_height}{Numeric, relative height of the side panel
showing gene structure. Default: \code{0.2}.}
}
\value{
A \code{ggplot} object displaying the requested signal(s) along
the genomic coordinates, faceted by sample (and optionally merged
sample) and transcript region, with gene structure drawn at the side panel.
}
\description{
This function visualizes ribosome footprint occupancy and/or RNA read
coverage along transcripts for a given gene, together with the underlying
transcript structure (exons, CDS, UTRs). It returns a \code{ggplot} object
that can be further customized.
}
\seealso{
\code{\link{get_occupancy}}, \code{\link{get_coverage}} for preprocessing;
\code{ggplot2::facet_grid}, \code{ggside} for panel layout.
}
