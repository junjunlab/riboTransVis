% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/serp-implementation-methods.R
\name{get_enrichment}
\alias{get_enrichment}
\alias{get_enrichment,serp-method}
\title{Get Enrichment Values From a serp Object}
\usage{
get_enrichment(object, ...)

\S4method{get_enrichment}{serp}(object, smooth = TRUE, window_size = 45)
}
\arguments{
\item{object}{A \code{serp} object containing metadata, occupancy, and gene annotation information.}

\item{...}{Additional arguments (currently unused).}

\item{smooth}{Logical; whether to apply smoothing based on Agresti-Coull-based estimation in sliding windows. Default is \code{TRUE}.}

\item{window_size}{Integer; width of the sliding window applied when smoothing. Default is \code{45}.}
}
\value{
A modified \code{serp} object with an additional \code{enriched_ratio} slot containing a data frame of enrichment values.
}
\description{
This function calculates the enrichment of IP (e.g., Ribo-seq) signal over total RNA signal
for each transcript of interest in the serp object. Optionally, a smoothing operation
can be applied using a sliding window and Agresti-Coull confidence intervals.
}
\details{
The function computes the enrichment value (IP RPM / total RPM) across each aligned position.
If \code{smooth=TRUE}, the method uses a sliding window along the CDS to estimate local enrichment
with Agresti-Coull confidence intervals and outputs average enrichments corrected for IP/total mapped read ratio.
If smoothing is disabled (\code{smooth=FALSE}), enrichment is averaged in codon-resolution (3-nt bins).

Required slots in the \code{serp} object:
\itemize{
\item{\code{total_occupancy}}: data frame with columns 'sample', 'rname', 'pos', 'count', 'rpm'.
\item{\code{ip_occupancy}}: same structure as above for the IP (e.g., Ribo-seq) library.
\item{\code{library}}: metadata indicating mapped reads per library (must contain 'sample', 'type', 'mappped_reads').
\item{\code{features}}: transcript annotation with fields such as exon length, CDS start/stop, transcript ID, etc.
\item{\code{gene_name}}: character string indicating the target gene.
}

The calculated result is stored in the \code{@enriched_ratio} slot of the \code{serp} object.
}
\examples{
\dontrun{
# Assuming 'serp_obj' is a valid serp object:
serp_obj <- get_enrichment(serp_obj, smooth = TRUE, window_size = 45)
}

}
