% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualization-QC.R
\name{metagene_plot}
\alias{metagene_plot}
\alias{metagene_plot,ribotrans-method}
\title{Metagene Plot for Ribosome Profiling Data}
\usage{
metagene_plot(object, ...)

\S4method{metagene_plot}{ribotrans}(
  object,
  merge_rep = FALSE,
  do_offset_correct = FALSE,
  position_shift = 0,
  norm_method = c("average", "tpm"),
  min_cds_length = 600,
  min_counts = 64,
  exclude_length = c(90, 90),
  type = c("rel2start", "rel2stop"),
  return_data = FALSE,
  mode = c("nt", "codon"),
  read_length = c(25, 35),
  rel2st_dist = c(-50, 100),
  rel2sp_dist = c(-100, 50),
  facet_wrap = ggplot2::facet_wrap(~sample)
)
}
\arguments{
\item{object}{A \code{ribotrans} object containing ribosome profiling data.}

\item{...}{Additional arguments (currently unused).}

\item{merge_rep}{Logical. Whether to merge replicate samples by \code{sample_group}. Default is \code{FALSE}.}

\item{do_offset_correct}{Logical, whether to perform read position offset correction (default: FALSE).}

\item{position_shift}{Numeric, shift value for offset correction (default: 0).}

\item{norm_method}{Normalization method, either "average" or "tpm" (default: "average").}

\item{min_cds_length}{Minimum CDS length to include in analysis (default: 600).}

\item{min_counts}{Minimum read counts for a transcript to be included (default: 64).}

\item{exclude_length}{A vector of two values specifying excluded regions near start and stop codons (default: c(90,90)).}

\item{type}{Plot relative to "rel2start" or "rel2stop" (default: "rel2start").}

\item{return_data}{Logical, whether to return processed data instead of plot (default: FALSE).}

\item{mode}{Visualization mode, either "nt" or "codon" (default: "nt").}

\item{read_length}{Range of read lengths to include (default: c(25,31)).}

\item{rel2st_dist}{Distance range for plotting relative to start codon (default: c(-50,100)).}

\item{rel2sp_dist}{Distance range for plotting relative to stop codon (default: c(-100,50)).}

\item{facet_wrap}{ggplot2 facet_wrap function for sample visualization (default: facet_wrap(~sample)).}
}
\value{
A ggplot object showing ribosome occupancy, or a data frame if \code{return_data = TRUE}
}
\description{
Generate a metagene plot to visualize ribosome occupancy across coding sequences.
The plot can be generated relative to the start or stop codon, with various
normalization and visualization options.
}
\details{
This method creates a metagene plot from ribosome profiling data with several key features:
\itemize{
\item Supports offset correction for read positioning
\item Multiple normalization methods (average, TPM)
\item Filtering for CDS length and read counts
\item Visualization by nucleotide or codon
\item Flexible plotting relative to start or stop codon
}
}
\examples{
\dontrun{
# Basic usage
metagene_plot(ribo_object)

# With custom parameters
metagene_plot(ribo_object,
              do_offset_correct = TRUE,
              norm_method = "tpm",
              type = "rel2stop")

# Return data instead of plot
metagene_data <- metagene_plot(ribo_object, return_data = TRUE)
}


}
\seealso{
\code{\link{do_offset_correction}} for read position correction
}
