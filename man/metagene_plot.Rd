% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metagene-plot.R
\name{metagene_plot}
\alias{metagene_plot}
\alias{metagene_plot,ribotrans-method}
\title{Generate metagene plots for ribosome profiling data}
\usage{
metagene_plot(object, ...)

\S4method{metagene_plot}{ribotrans}(
  object,
  merge_rep = FALSE,
  var_alpha = 0.5,
  selected_genes = NULL,
  do_offset_correct = FALSE,
  position_shift = 0,
  method = c("median", "mean", "sum"),
  do_bootstrap = FALSE,
  boot_n = 1000,
  conf = 0.95,
  min_cds_length = 600,
  min_counts = 64,
  exclude_length = c(90, 90),
  type = c("rel2start", "rel2stop"),
  return_data = FALSE,
  mode = c("nt", "codon"),
  read_length = c(25, 35),
  rel2st_dist = c(-50, 100),
  rel2sp_dist = c(-100, 50),
  facet_wrap = ggplot2::facet_wrap(~sample)
)
}
\arguments{
\item{object}{A ribotrans object containing ribosome profiling data}

\item{...}{Additional arguments (currently unused).}

\item{merge_rep}{Logical; whether to merge replicates. Default is FALSE.}

\item{var_alpha}{Numeric; transparency level for variance ribbon (standard deviation or confidence intervals). Default is 0.5.}

\item{selected_genes}{Character vector; subset of genes to analyze. Default is NULL (all genes).}

\item{do_offset_correct}{Logical; whether to apply offset correction to read positions. Default is FALSE.}

\item{position_shift}{Numeric; number of nucleotides to shift read positions. Default is 0.}

\item{method}{Character; method to aggregate data ("median", "mean", or "sum"). Default is "median".}

\item{do_bootstrap}{Logical; whether to perform bootstrap resampling. Default is FALSE.}

\item{boot_n}{Numeric; number of bootstrap iterations. Default is 1000.}

\item{conf}{Numeric; confidence level for bootstrap confidence intervals. Default is 0.95.}

\item{min_cds_length}{Numeric; minimum CDS length to include in analysis. Default is 600.}

\item{min_counts}{Numeric; minimum read count threshold for genes. Default is 64.}

\item{exclude_length}{Numeric vector; regions to exclude near start/stop codons, c(start_region, stop_region). Default is c(90,90).}

\item{type}{Character; reference point for alignment ("rel2start" or "rel2stop"). Default is "rel2start".}

\item{return_data}{Logical; if TRUE, returns the data frame instead of the plot. Default is FALSE.}

\item{mode}{Character; count mode ("nt" for nucleotide-level or "codon" for codon-level aggregation). Default is "nt".}

\item{read_length}{Numeric vector; range of read lengths to include c(min_length, max_length). Default is c(25,35).}

\item{rel2st_dist}{Numeric vector; region to plot around start codon c(upstream, downstream). Default is c(-50,100).}

\item{rel2sp_dist}{Numeric vector; region to plot around stop codon c(upstream, downstream). Default is c(-100,50).}

\item{facet_wrap}{A facet_wrap specification for ggplot2. Default is ggplot2::facet_wrap(~sample).}
}
\value{
If return_data is FALSE (default), returns a ggplot object. If return_data is TRUE, returns a data frame with the processed data.
}
\description{
Creates a metagene plot showing the average ribosome occupancy relative to start or stop codons
from ribosome profiling data. This function allows for various customizations including data filtering,
statistical methods, and visualization options.
}
\details{
This function analyzes ribosome density patterns around start or stop codons by normalizing
read counts and plotting the average profile. It supports various filtering criteria to focus on
specific subsets of the data.

When merge_rep=TRUE, replicates are aggregated by their sample_group and displayed with standard deviation.
When do_bootstrap=TRUE, bootstrap confidence intervals are calculated and displayed.

The function normalizes raw counts by the average count per nucleotide for each transcript before aggregation.
The final plot shows relative ribosome occupancy across the specified region.
}
\note{
\itemize{
\item merge_rep=TRUE and do_bootstrap=TRUE cannot be used together.
\item For codon-level analysis (mode="codon"), positions are converted from nucleotides to codons.
}
}
\examples{
\dontrun{
# Basic metagene plot around start codons
metagene_plot(ribo_obj)

# Customize plot with bootstrap confidence intervals
metagene_plot(ribo_obj, do_bootstrap = TRUE,
              boot_n = 500, conf = 0.9)

# Plot around stop codons with merged replicates
metagene_plot(ribo_obj, type = "rel2stop",
              merge_rep = TRUE, var_alpha = 0.3)

# Analyze specific genes at codon resolution
metagene_plot(ribo_obj, mode = "codon",
              selected_genes = c("YAL001C", "YAL002W"))

# Return data instead of plot for custom visualization
plot_data <- metagene_plot(ribo_obj, return_data = TRUE)
}

}
