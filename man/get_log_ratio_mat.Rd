% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{get_log_ratio_mat}
\alias{get_log_ratio_mat}
\title{Calculate Log-Ratio Matrix Based on Binomial Significance}
\usage{
get_log_ratio_mat(fg = NULL, bg = NULL, bg_freq = NULL)
}
\arguments{
\item{fg}{A numeric matrix representing the counts of residues in the foreground data.
Rows correspond to residue types (e.g., amino acids), and columns correspond to positions.
Row names should be residue single-letter codes.}

\item{bg}{(Optional) Background matrix. This argument is unused in the current function.}

\item{bg_freq}{A numeric matrix of same dimension as \code{fg}, representing the expected
background frequencies (probabilities) for each residue at each position.}
}
\value{
A numeric matrix of the same dimensions as \code{fg}, where each element gives
the negative base-10 logarithm of the over/under binomial probability ratio:
\deqn{-log_{10}\left( \frac{P(k \geq K \mid N, p)}{P(k \leq K \mid N, p)} + \varepsilon \right)}
If the observed count \code{K} is zero, the corresponding log-ratio is set to 0.
}
\description{
This function computes a log-ratio matrix for each amino acid at each position
based on a foreground count matrix and corresponding background frequencies.
The log-ratio quantifies the statistical significance of over- or under-representation
of each residue using a binomial model, and results are suitable for pLogo-style visualization.
}
\details{
For each residue \code{i} and position \code{j}, this function calculates:
\itemize{
\item \code{K}: Observed count of residue i at position j in the foreground.
\item \code{N}: Total count of residues at position j in the foreground.
\item \code{p}: Background frequency for residue i at position j.
}
Then computes:
\itemize{
\item \code{pr_over = P(k >= K | N, p)}: Binomial upper-tail probability
\item \code{pr_under = P(k <= K | N, p)}: Binomial lower-tail probability
\item \code{ratio = pr_over / pr_under + 1e-10}
\item The final score is \code{-log10(ratio)}
}
This formulation captures the log-ratio between over- and underrepresentation probabilities,
following a heuristic similar to pLogo residue height calculations.
}
